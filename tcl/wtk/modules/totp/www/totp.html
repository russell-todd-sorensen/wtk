<!DOCTYPE html>
<!-- saved from url=(0071)https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Tcl -->
<html lang="en" dir="ltr" class="client-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Time-based one-time password algorithm - Rosetta Code</title>
<script type="text/javascript" async="" src="./totp_files/ga.js"></script><script src="./totp_files/7qaJovFEYxjqsAZAxmfekTkNrFg.js"></script><script type="text/javascript">document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script type="text/javascript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Time-based_one-time_password_algorithm","wgTitle":"Time-based one-time password algorithm","wgCurRevisionId":349425,"wgRevisionId":349425,"wgArticleId":17949,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Draft Programming Tasks","Security","WikipediaSourced","C sharp","Cach√© ObjectScript","Go","Julia","Nim","Perl","Phix","PicoLisp","Racket","Raku","Tcl","Wren","Wren-long","Wren-crypto","Wren-date","Wren-srandom","Zkl"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct",
"Nov","Dec"],"wgRelevantPageName":"Time-based_one-time_password_algorithm","wgRelevantArticleId":17949,"wgIsProbablyEditable":!0,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Time-based_One-time_Password_Algorithm","sfgAutocompleteValues":[],"sfgAutocompleteOnAllChars":!1,"sfgFieldProperties":[],"sfgDependentFields":[],"sfgShowOnSelect":[],"sfgScriptPath":"/mw/extensions/SemanticForms","sdgDownArrowImage":"/mw/extensions/SemanticDrilldown/skins/down-arrow.png","sdgRightArrowImage":"/mw/extensions/SemanticDrilldown/skins/right-arrow.png","wgInternalRedirectTargetUrl":"/wiki/Time-based_one-time_password_algorithm"});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["mediawiki.action.view.redirect","ext.smw.style","ext.smw.tooltips","mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="./totp_files/load.php">
<style>
.qtip,.qtip{position:absolute;left:-28000px;top:-28000px;display:none;max-width:280px;min-width:50px;font-size:10.5px;line-height:12px;direction:ltr}.qtip-content{position:relative;padding:5px 9px;overflow:hidden;text-align:left;word-wrap:break-word}.qtip-titlebar{position:relative;padding:5px 35px 5px 10px;overflow:hidden;border-width:0 0 1px;font-weight:bold}.qtip-titlebar + .qtip-content{border-top-width:0 !important} .qtip-close{position:absolute;right:-9px;top:-9px;cursor:pointer;outline:medium none;border-width:1px;border-style:solid;border-color:transparent}.qtip-titlebar .qtip-close{right:4px;top:50%;margin-top:-9px}* html .qtip-titlebar .qtip-close{top:16px} .qtip-titlebar .ui-icon,.qtip-icon .ui-icon{display:block;text-indent:-1000em;direction:ltr;vertical-align:middle}.qtip-icon,.qtip-icon .ui-icon{-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;text-decoration:none}.qtip-icon .ui-icon{width:18px;height:14px;text-align:center;text-indent:0;font:normal bold 10px/13px Tahoma,sans-serif;color:inherit;background:transparent none no-repeat -100em -100em} .qtip-focus{} .qtip-hover{} .qtip-default{border-width:1px;border-style:solid;border-color:#F1D031;background-color:#FFFFA3;color:#555}.qtip-default .qtip-titlebar{background-color:#FFEF93}.qtip-default .qtip-icon{border-color:#CCC;background:#F1F1F1;color:#777}.qtip-default .qtip-titlebar .qtip-close{border-color:#AAA;color:#111} .qtip-light{background-color:white;border-color:#E2E2E2;color:#454545}.qtip-light .qtip-titlebar{background-color:#f1f1f1} .qtip-dark{background-color:#505050;border-color:#303030;color:#f3f3f3}.qtip-dark .qtip-titlebar{background-color:#404040}.qtip-dark .qtip-icon{border-color:#444}.qtip-dark .qtip-titlebar .ui-state-hover{border-color:#303030} .qtip-cream{background-color:#FBF7AA;border-color:#F9E98E;color:#A27D35}.qtip-cream .qtip-titlebar{background-color:#F0DE7D}.qtip-cream .qtip-close .qtip-icon{background-position:-82px 0} .qtip-red{background-color:#F78B83;border-color:#D95252;color:#912323}.qtip-red .qtip-titlebar{background-color:#F06D65}.qtip-red .qtip-close .qtip-icon{background-position:-102px 0}.qtip-red .qtip-icon{border-color:#D95252}.qtip-red .qtip-titlebar .ui-state-hover{border-color:#D95252} .qtip-green{background-color:#CAED9E;border-color:#90D93F;color:#3F6219}.qtip-green .qtip-titlebar{background-color:#B0DE78}.qtip-green .qtip-close .qtip-icon{background-position:-42px 0} .qtip-blue{background-color:#E5F6FE;border-color:#ADD9ED;color:#5E99BD}.qtip-blue .qtip-titlebar{background-color:#D0E9F5}.qtip-blue .qtip-close .qtip-icon{background-position:-2px 0} .qtip-shadow{-webkit-box-shadow:1px 1px 3px 1px rgba(0,0,0,0.15);-moz-box-shadow:1px 1px 3px 1px rgba(0,0,0,0.15);box-shadow:1px 1px 3px 1px rgba(0,0,0,0.15)} .qtip-rounded,.qtip-tipsy,.qtip-bootstrap{-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px} .qtip-youtube{-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-webkit-box-shadow:0 0 3px #333;-moz-box-shadow:0 0 3px #333;box-shadow:0 0 3px #333;color:white;border-width:0;background:#4A4A4A;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#4A4A4A),color-stop(100%,black));background-image:-webkit-linear-gradient(top,#4A4A4A 0,black 100%);background-image:-moz-linear-gradient(top,#4A4A4A 0,black 100%);background-image:-ms-linear-gradient(top,#4A4A4A 0,black 100%);background-image:-o-linear-gradient(top,#4A4A4A 0,black 100%)}.qtip-youtube .qtip-titlebar{background-color:#4A4A4A;background-color:rgba(0,0,0,0)}.qtip-youtube .qtip-content{padding:.75em;font:12px arial,sans-serif;filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);-ms-filter:"progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);"}.qtip-youtube .qtip-icon{border-color:#222}.qtip-youtube .qtip-titlebar .ui-state-hover{border-color:#303030} .qtip-jtools{background:#232323;background:rgba(0,0,0,0.7);background-image:-webkit-gradient(linear,left top,left bottom,from(#717171),to(#232323));background-image:-moz-linear-gradient(top,#717171,#232323);background-image:-webkit-linear-gradient(top,#717171,#232323);background-image:-ms-linear-gradient(top,#717171,#232323);background-image:-o-linear-gradient(top,#717171,#232323);border:2px solid #ddd;border:2px solid rgba(241,241,241,1);-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-webkit-box-shadow:0 0 12px #333;-moz-box-shadow:0 0 12px #333;box-shadow:0 0 12px #333} .qtip-jtools .qtip-titlebar{background-color:transparent;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A)"}.qtip-jtools .qtip-content{filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323)"}.qtip-jtools .qtip-titlebar,.qtip-jtools .qtip-content{background:transparent;color:white;border:0 dashed transparent}.qtip-jtools .qtip-icon{border-color:#555}.qtip-jtools .qtip-titlebar .ui-state-hover{border-color:#333} .qtip-cluetip{-webkit-box-shadow:4px 4px 5px rgba(0,0,0,0.4);-moz-box-shadow:4px 4px 5px rgba(0,0,0,0.4);box-shadow:4px 4px 5px rgba(0,0,0,0.4);background-color:#D9D9C2;color:#111;border:0 dashed transparent}.qtip-cluetip .qtip-titlebar{background-color:#87876A;color:white;border:0 dashed transparent}.qtip-cluetip .qtip-icon{border-color:#808064}.qtip-cluetip .qtip-titlebar .ui-state-hover{border-color:#696952;color:#696952} .qtip-tipsy{background:black;background:rgba(0,0,0,.87);color:white;border:0 solid transparent;font-size:11px;font-family:'Lucida Grande',sans-serif;font-weight:bold;line-height:16px;text-shadow:0 1px black}.qtip-tipsy .qtip-titlebar{padding:6px 35px 0 10;background-color:transparent}.qtip-tipsy .qtip-content{padding:6px 10}.qtip-tipsy .qtip-icon{border-color:#222;text-shadow:none}.qtip-tipsy .qtip-titlebar .ui-state-hover{border-color:#303030} .qtip-tipped{border:3px solid #959FA9;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-color:#F9F9F9;color:#454545;font-weight:normal;font-family:serif}.qtip-tipped .qtip-titlebar{border-bottom-width:0;color:white;background:#3A79B8;background-image:-webkit-gradient(linear,left top,left bottom,from(#3A79B8),to(#2E629D));background-image:-webkit-linear-gradient(top,#3A79B8,#2E629D);background-image:-moz-linear-gradient(top,#3A79B8,#2E629D);background-image:-ms-linear-gradient(top,#3A79B8,#2E629D);background-image:-o-linear-gradient(top,#3A79B8,#2E629D);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D);-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D)"}.qtip-tipped .qtip-icon{border:2px solid #285589;background:#285589}.qtip-tipped .qtip-icon .ui-icon{background-color:#FBFBFB;color:#555} .qtip-bootstrap{ font-size:14px;line-height:20px;color:#333333; padding:1px;background-color:#ffffff;border:1px solid #ccc;border:1px solid rgba(0,0,0,0.2);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 5px 10px rgba(0,0,0,0.2);-moz-box-shadow:0 5px 10px rgba(0,0,0,0.2);box-shadow:0 5px 10px rgba(0,0,0,0.2);-webkit-background-clip:padding-box;-moz-background-clip:padding;background-clip:padding-box}.qtip-bootstrap .qtip-titlebar{ padding:8px 14px;margin:0;font-size:14px;font-weight:normal;line-height:18px;background-color:#f7f7f7;border-bottom:1px solid #ebebeb;-webkit-border-radius:5px 5px 0 0;-moz-border-radius:5px 5px 0 0;border-radius:5px 5px 0 0}.qtip-bootstrap .qtip-titlebar .qtip-close{ right:11px;top:45%;border-style:none}.qtip-bootstrap .qtip-content{ padding:9px 14px}.qtip-bootstrap .qtip-icon{ background:transparent}.qtip-bootstrap .qtip-icon .ui-icon{ width:auto;height:auto; float:right;font-size:20px;font-weight:bold;line-height:18px;color:#000000;text-shadow:0 1px 0 #ffffff;opacity:0.2;filter:alpha(opacity=20)}.qtip-bootstrap .qtip-icon .ui-icon:hover{ color:#000000;text-decoration:none;cursor:pointer;opacity:0.4;filter:alpha(opacity=40)} .qtip:not(.ie9haxors) div.qtip-content,.qtip:not(.ie9haxors) div.qtip-titlebar{filter:none;-ms-filter:none} .qtip .qtip-tip{margin:0 auto;overflow:hidden;z-index:10}.qtip .qtip-tip,.qtip .qtip-tip .qtip-vml{position:absolute;color:#123456;background:transparent;border:0 dashed transparent}.qtip .qtip-tip canvas{top:0;left:0}.qtip .qtip-tip .qtip-vml{behavior:url("https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/jquery/#default#VML");display:inline-block;visibility:visible} #qtip-overlay{position:fixed;left:-10000em;top:-10000em} #qtip-overlay.blurs{cursor:pointer} #qtip-overlay div{position:absolute;left:0;top:0;width:100%;height:100%;background-color:black;opacity:0.7;filter:alpha(opacity=70);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=70)"} .qtipmodal-ie6fix{position:absolute !important}
div.smwtt{color:#000000} span.smwttpersist span.smwttcontent{color:#888888;font-style:italic;font-size:90%} span.smwttinline span.smwttcontent{display:none;speak:none} span.smwtticon{display:none} span.smwttactivepersist{cursor:help;color:#0000C8} span.smwttactiveinline{color:#BB7700;text-decoration:none} img.smwttimg{padding-right:5px;padding-left:4px} .smwttcontent{display:none} .smwtticon{padding:14px 12px 0 0;white-space:nowrap;margin-bottom:-1px} .smwtticon.info{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABmJLR0QAQACXAOIX6M4XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1woNCAQvupvvrgAAAgpJREFUKBUFwTtME3EAwOHf3f961+vd9Sh9HEVINUrFhAbRmCgGo9FodCFMLhomJ6MmJsbF1Z2ExMHBUQc3BmOigyERB0ElQHgECRYECrRC26OPa3t+nwQAAI7aO/K458yJeK8qOA74dY/1hbWdxZWJsVUoeAAKAImh2NDdR/duD54cdRLRdMQydB84KJaPzufyyx+6Tr+Zej/2jr1vBUHiin3j/pPnwzcvPMv0OKlb/YlAT4cupR1d0lRNNWwrmUhEB+tmSl7/vTktMiNPhy9dvviyM2FYnZEgpRp8WS3htaC/W2du64iWLAUl1RgoY84qiiJdU03TKFR9vv+tIZQGsiTojqg0WrDtwlHVR7PscCDAVaXoEV3KN+hCELUVVBFgNBOkXZd5NVPhoC6TL0J2v8FhnbiCUBtlX2WzInB1jZiuEQ4KfhVgrR7ErUO+UsMlgCwUT6FRW9YU2TdMXbIsjbglmD+EPQ9iYQFo1Go6Xq3c8hveolze2/hY3M6u2IaGHRI4JpxthyRVHAPCIQXbDFLcyi6WcuufhLs2lXMxsy0tkk51tDkdYVU6ZkosbFXxAwF290vN6amfM0uf374oTI5/lQAAYfddP5e58/BBuivel4qF4k0f/uy7u0sbubn5ifHX7srkLNCUAAAAQtFUW/LUQLI9HHGaPv6/Yj63s/pju1LYPAQA+A8p2cUweh5dZAAAAABJRU5ErkJggg==) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/info.png?34b97) no-repeat left bottom!ie}.smwtticon.service{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABmJLR0QAQACXAOIX6M4XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1woNCAQvupvvrgAAAgpJREFUKBUFwTtME3EAwOHf3f961+vd9Sh9HEVINUrFhAbRmCgGo9FodCFMLhomJ6MmJsbF1Z2ExMHBUQc3BmOigyERB0ElQHgECRYECrRC26OPa3t+nwQAAI7aO/K458yJeK8qOA74dY/1hbWdxZWJsVUoeAAKAImh2NDdR/duD54cdRLRdMQydB84KJaPzufyyx+6Tr+Zej/2jr1vBUHiin3j/pPnwzcvPMv0OKlb/YlAT4cupR1d0lRNNWwrmUhEB+tmSl7/vTktMiNPhy9dvviyM2FYnZEgpRp8WS3htaC/W2du64iWLAUl1RgoY84qiiJdU03TKFR9vv+tIZQGsiTojqg0WrDtwlHVR7PscCDAVaXoEV3KN+hCELUVVBFgNBOkXZd5NVPhoC6TL0J2v8FhnbiCUBtlX2WzInB1jZiuEQ4KfhVgrR7ErUO+UsMlgCwUT6FRW9YU2TdMXbIsjbglmD+EPQ9iYQFo1Go6Xq3c8hveolze2/hY3M6u2IaGHRI4JpxthyRVHAPCIQXbDFLcyi6WcuufhLs2lXMxsy0tkk51tDkdYVU6ZkosbFXxAwF290vN6amfM0uf374oTI5/lQAAYfddP5e58/BBuivel4qF4k0f/uy7u0sbubn5ifHX7srkLNCUAAAAQtFUW/LUQLI9HHGaPv6/Yj63s/pju1LYPAQA+A8p2cUweh5dZAAAAABJRU5ErkJggg==) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/info.png?34b97) no-repeat left bottom!ie}.smwtticon.warning{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAZ1JREFUKFOVy79rE3EcxvH39+7y8/q9pF4S0xi0mEiaMxV68Yxg8PeiVyhV6iCIQhErHUScFJxcHAX/Azf/AgWXWlsUhyrYioMiqKgoiEgrJTH3cSuldvE9Pg8vkw3Nt6lfHuZ68g9fnv/k2/pPRDDWD098bD1gTO4cdS+NNowp38ZhQ2tgZgQSWo3kDgyPpU/esSuHd4fnK6o1lERtCuIp0tmGO73sHavevf8B8Y7uaDT7pwMXvSmwEkbgNHeFb1eLPH22wNJKnka7enxAG+1/wKxPpq+SuuaeOKSzuSQxq0vGjZML99vj+xJXDmoKa2DOx0znOVUcL7fNrXl8v0OtZhIEv1GFFLUJt3XW43TRJAZgGBal/lbsjN0sZeENIkuEoQUsAq/RQcZpHjEnzpUpA/DqAld/zOjVqOdJFO2RuXlPhuo5efBwUKJou0S9gvx6HO/cG+OmiGD1FdSU3tZNyNdPAFQd4cbFHvUty8jnCOhhl6JYfZBJ4JY1+1IeObc770S6ChClQCvhxaKwEAEISqE+vuf7XkCJCP/TX7cEexPi9whUAAAAAElFTkSuQmCC) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/warning.png?06a3c) no-repeat left bottom!ie}.smwtticon.note{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgtJREFUeNokUctqU1EUXefk5iY3D2MrSWOamyq9jYO2BovUR41O1Iykov6Bc6WDDh36A4oKnYkORZBCoA6KI1GrEKhoFWOo1qhJk6Z539c57sTB5gzOWns9NpMA3KCK0s0TsHwiBsW3qPi0OYerbmP89IaVnFvtMn/dmEginU5DITyYLSA4y40embp3MDWVVoNhgKvot1sob699/OqdvM0MY32AVTrZWZhhfnEsk85HEikOxoERnbYwBLxeGNH4jK/wdq1W1Bd7h8fySnlei4WT0ZV4ROWivQt4A+AzV0DrIV8/AtQA9Onjyt7G6spmOJHhb6IXrkbCnqOyuw+YNL0aTRPSpOnVidgE7A70Q/7x+pf315Wgph1TpAVBOcApktUBnN7/t9/AoBT6REAl8f3dBcW07R1pdSGkSvaJIBzIWpHUWkRqDrNAWENFIWJBZafWKZgjbWghDZIRgUK7Hx4PugNzXSK1wZmLVq0CO5ot8kw2Vyg70U+M/Eu7D0lWPLm78GSXKEOD7JlAu4rvTVWwmPGc/frzF63S5kIgv7SeOGCp0usHUmfAhAtW3SIdga2ffZTnl++nZk/dYlJKkDBePXtyOfb56cO4W5rUWH9YQEcEsI2U+9u48WD63KVlY0K3hpeWjgMxqr+snr9zslL5do3t/ThLnYXsUKLIY8YLj22+Y441gOKfAAMAeeDgUIIDAXwAAAAASUVORK5CYII=) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/note.png?3c504) no-repeat left bottom!ie}  span.smwbuiltin,span.smwttactiveinline span.smwbuiltin{font-style:italic} div.smwpre{white-space:pre;font-family:monospace;padding:1em;border:1px dashed #2f6fab;color:black;background-color:#f9f9f9;line-height:1.1em;margin-bottom:0.5em;margin-top:0.5em} #smwfootbr{clear:both} span.smwsortkey{display:none} a.sortheader:hover{text-decoration:none} div.smwtimeline{border:1px solid #AAAAAA;background-color:#F9F9F9;  }span.smwtlevent,span.smwtlband,span.smwtlsize,span.smwtlposition{display:none;speak:none}span.smwtlcomment{font-style:italic;padding:5px} div.smwfact{clear:both;background-color:#F9F9F9;padding:5px;margin-top:1em;border:1px solid #AAAAAA;font-size:95%}div.smwfact td,div.smwfact tr,div.smwfact table{background-color:#F9F9F9}span.smwfactboxhead{font-size:110%;font-weight:bold;float:left}table.smwfacttable{border-top:1px dotted #AAAAAA;width:100%;clear:both}td.smwpropname,th.smwpropname,td.smwspecname{text-align:right;vertical-align:top;padding-right:1em}td.smwprops,td.smwspecs{vertical-align:top;width:75%}div.smwhr hr{background-color:#DDDDDD;color:#DDDDDD} span.smwwarning{color:#888888;font-style:italic;font-size:90%} span.smwsearchicon{padding-right:16px;margin-right:2px;color:#888888;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAABC1BMVEU+S114jayTpb6Im7eMn7qhsceBlbOYqcKXp8GDl7N2i6rJ0uCYqcJogKB9kq+KnLipt81qgKF8kK9qgKF4jayntstheJpsgqOSo75RaIxWbpCIm7fAy9tlfJ5keptedZdHXX5bcpWBlbOersajssmVp79lfJ5thKN2i6phd5lTa45GW3lPZ4plfJ5le5xRaYxbcpV3jKt2i6pWbpBKYoVOZolSao2HmrZ4jaxTa45JYYRJYYSHmrZedZdFWnhTa45ieZtVbZCzv9Lm6/Ha4Onp7fKks8rb4uvf5e3h5u7X3um2wtXQ2OTAy9vW3efl6fCmtcrJ0uDGz96jssm5xdaruc6uu8+9yNnt8PXd7KeZAAAAQnRSTlMACfbevtlP8sRPTv2lFfRF2Cz1A7jZLdG4HFbm/q8vBAxjxO/syrHaxk0EByM4NyUrutRNBAI6xeJdADjU4QFO3NoNTLabAAAAeElEQVQIHQXBvQ7BUACA0e+7P020EQsDC4NBYrZJ38BTewcmg8XGomnjRso50QlUuSkA1p9TenF2+oRUH7/DzMoChJJH3n2bEpDS0CS7kAVCntd9txhjBFzp7he86h03qqp6kb2qbm8qABy06Y0A8FjHcTkIANCqf7L2G5qa4UzTAAAAAElFTkSuQmCC) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/searchgray_iconsmall.png?bbd58) center right no-repeat!ie}#bodyContent span.smwsearch a{padding-right:16px;margin-right:2px;color:#888888;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAABC1BMVEU+S114jayTpb6Im7eMn7qhsceBlbOYqcKXp8GDl7N2i6rJ0uCYqcJogKB9kq+KnLipt81qgKF8kK9qgKF4jayntstheJpsgqOSo75RaIxWbpCIm7fAy9tlfJ5keptedZdHXX5bcpWBlbOersajssmVp79lfJ5thKN2i6phd5lTa45GW3lPZ4plfJ5le5xRaYxbcpV3jKt2i6pWbpBKYoVOZolSao2HmrZ4jaxTa45JYYRJYYSHmrZedZdFWnhTa45ieZtVbZCzv9Lm6/Ha4Onp7fKks8rb4uvf5e3h5u7X3um2wtXQ2OTAy9vW3efl6fCmtcrJ0uDGz96jssm5xdaruc6uu8+9yNnt8PXd7KeZAAAAQnRSTlMACfbevtlP8sRPTv2lFfRF2Cz1A7jZLdG4HFbm/q8vBAxjxO/syrHaxk0EByM4NyUrutRNBAI6xeJdADjU4QFO3NoNTLabAAAAeElEQVQIHQXBvQ7BUACA0e+7P020EQsDC4NBYrZJ38BTewcmg8XGomnjRso50QlUuSkA1p9TenF2+oRUH7/DzMoChJJH3n2bEpDS0CS7kAVCntd9txhjBFzp7he86h03qqp6kb2qbm8qABy06Y0A8FjHcTkIANCqf7L2G5qa4UzTAAAAAElFTkSuQmCC) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/searchgray_iconsmall.png?bbd58) center right no-repeat!ie}#bodyContent span.smwsearch a:hover{text-decoration:none;color:#0000FF;padding-right:18px;margin-right:0px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAALySURBVDgRlcFraNVlHMDx7+95nv/zP+d/LnObeVtz2uyCrRUVDAIHMbIXltUgKRYR7kWvupjYDSEkgkgoKCiJfGeRzqw0CvYuahBWyrZWuWihuWNrZ+e2c87OZf//U1DB8EXU52P27XuV9takiiVS95ZjV+xdjK3uxbO0sFi15ewnlBYO1pZqP9YbTZQSLmeUOF1eNs+fj219QXdt1i2rfXwPlpxKho3qbpme3B7+/N2wUoyKCJcz9VB2ZFfdcKDtxh7p3hiRiMFSDfKFJjadwF/fd+V8pfhmYXK83ynJgLCSKanU47Et18qmDsc1axXtAlPzEekOS7XhSK3SmNt6uuemJnc2K5VDog0rmaptvWXtmgRBLKJNBL/h8DyhPRBqScGKI31dB2c8c2exsHhIW8tKZtmm/MBGFIohZ2oRQaDYkFYECgLAOjBa0ajVk8VSGc+3rGSa+Us18XQ8bIREgSKIC74G5aAdsEAjjCgXioXSYgVTX0bE8Q+zMD0xVs2V7tKtCepNiJRQB1JAClgjwskvvuXCzOypWn2ZeLiEA5wD58DkZs69fO7UyYGBPQ/FYxoi51D8JRBhNl/i05FRWlpaLtzReZbOxiSzRcNcCXIVMErL2E+fffSYNe61/t33pUxbEgeIwOmpGY6/fQxj4mzrTe/vyUz0zzflLU/CeSOgcRhRiqhZPzx+/OjEr998tXdDd2dfPBHT1flc4eL0Lyc6OzeeXt9WHu52Xw5etTk9UP0+f2szsg87XMEhGP4kWiNEXxczmQfERQSpBIXMHKVcka1XO/QP76/rvr9rsOf2IezIu3f/PpY/8lvRewTIGv4mImjPw/MtnvXwYhbtB9jqefzKxaMfj+R74+u6nrh+1xDN8MiO7Gj+8ELZDhv+lcOJRhtTuZRt7Hn9xQ/do88MPnnz0BAPyns73ziRf8fwH/lWu9mF5acPHvggevalXU+137QN9fn4PYb/wfN0M1cKn3tl/7FNbVt6tk9L39k/AH8KLAsrDQkDAAAAAElFTkSuQmCC) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/search_icon.png?a5d66) center right no-repeat!ie}#bodyContent span.swmfactboxheadbrowse a{padding-right:16px;margin-right:2px;color:#000000;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAA5FBMVEUAAADb3uv///+gqcBJYqGTmq24v9KJkamboLBtfqOnrbuSmqyqr7yVnK3o6e3n6OrKzdaWna7O0NWMlKiQl6qWm6yRma3DxczEyM+Olqyeo7J+iaamq7qZoLGMlKrg4eiYobqFjqfBxMyQl6hXbaGXnK+hprmcobPEx9BZbaGkqriIkayjp7d1g6iztsSytsZzf6GcobSaobjq6++Umq5abZ6aoLJre6NqeqJ7hqfg4umvtsp0g6h9iaff4el3hKVld6aUoL6wt8meo7SXnbCUm66Jkqnq6+64usRfcqOxs8Dm5+teFG05AAAAAXRSTlMAQObYZgAAAH9JREFUeF4dymMSRDEABOGZ5HFt27Zt3v8+m833r6saSqDl6aSC0ELhXN7r80egVBYZRmOMJ5LAIV0lsy55LRRRKlNYbs0SrDfQpBCybUgh2EXvH4aOPgZDtRkjtY0nmM7m5HtJrtYbYLvb07Z5PJ2hXMybad4fEtrz5TifL4AfAxMLmJTt7hwAAAAASUVORK5CYII=) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/browse_iconsmall.png?9997a) center right no-repeat!ie}#bodyContent span.swmfactboxheadbrowse a:hover{text-decoration:none;color:#0000FF;padding-right:18px;margin-right:0px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAA81BMVEUAAADByOQOLn7///8BInfg5O2xuthsf7ODk8CmqbEnQ4slQYoYNYJqea6BhZaSlJ9kbo5fc6xld62/v8Fnea6BhZdbb6lKY6axsrWIjJe/wMQ6UZOCkMVoeq6Gk79BWZpBWJqCkr4uSo8mRI8PLnqio6plcppIXp+LjprFxsgmQYMrRo4nRJI6TX+ytLyKl8xseah7ir9cbqUDJXeJl8xWbLBue6xPZaeYm6V+hqCLl841S34MLXwsSZJVaasSMYBcaYZUZphLYqBsfrFKYaB3iLcwS5EvSpFjeK1neq4zTpE2ToxQaKlSXoIMKW9idKyur7PDoCJEAAAAAXRSTlMAQObYZgAAAJtJREFUGFdlT8USg1AQ292HQ93d3d3dvf//NYWBHhhyS2ZiAAYCnpC7GoU/al5XsjPs9V9fk8tEPn8q+AlH6jGDxxMrwnQmm8N8oVjShXLljXhS1ANio9kCaK+7yIQ9aUeB4XgyhdkcGZOWA44kxnC0hZ3OeXHDcSTyurJwCg6LGXom7WKFmrVXRb1Ztcawu20YyI+nbbrznP3+D9crFuL3dLY6AAAAAElFTkSuQmCC) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/browse_icon.png?67c46) center right no-repeat!ie}#bodyContent span.smwbrowse a{padding-right:16px;margin-right:2px;color:#888888;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAA5FBMVEUAAADb3uv///+gqcBJYqGTmq24v9KJkamboLBtfqOnrbuSmqyqr7yVnK3o6e3n6OrKzdaWna7O0NWMlKiQl6qWm6yRma3DxczEyM+Olqyeo7J+iaamq7qZoLGMlKrg4eiYobqFjqfBxMyQl6hXbaGXnK+hprmcobPEx9BZbaGkqriIkayjp7d1g6iztsSytsZzf6GcobSaobjq6++Umq5abZ6aoLJre6NqeqJ7hqfg4umvtsp0g6h9iaff4el3hKVld6aUoL6wt8meo7SXnbCUm66Jkqnq6+64usRfcqOxs8Dm5+teFG05AAAAAXRSTlMAQObYZgAAAH9JREFUeF4dymMSRDEABOGZ5HFt27Zt3v8+m833r6saSqDl6aSC0ELhXN7r80egVBYZRmOMJ5LAIV0lsy55LRRRKlNYbs0SrDfQpBCybUgh2EXvH4aOPgZDtRkjtY0nmM7m5HtJrtYbYLvb07Z5PJ2hXMybad4fEtrz5TifL4AfAxMLmJTt7hwAAAAASUVORK5CYII=) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/browse_iconsmall.png?9997a) center right no-repeat!ie}#bodyContent span.smwbrowse a:hover{text-decoration:none;color:#0000FF;padding-right:18px;margin-right:0px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAA81BMVEUAAADByOQOLn7///8BInfg5O2xuthsf7ODk8CmqbEnQ4slQYoYNYJqea6BhZaSlJ9kbo5fc6xld62/v8Fnea6BhZdbb6lKY6axsrWIjJe/wMQ6UZOCkMVoeq6Gk79BWZpBWJqCkr4uSo8mRI8PLnqio6plcppIXp+LjprFxsgmQYMrRo4nRJI6TX+ytLyKl8xseah7ir9cbqUDJXeJl8xWbLBue6xPZaeYm6V+hqCLl841S34MLXwsSZJVaasSMYBcaYZUZphLYqBsfrFKYaB3iLcwS5EvSpFjeK1neq4zTpE2ToxQaKlSXoIMKW9idKyur7PDoCJEAAAAAXRSTlMAQObYZgAAAJtJREFUGFdlT8USg1AQ292HQ93d3d3dvf//NYWBHhhyS2ZiAAYCnpC7GoU/al5XsjPs9V9fk8tEPn8q+AlH6jGDxxMrwnQmm8N8oVjShXLljXhS1ANio9kCaK+7yIQ9aUeB4XgyhdkcGZOWA44kxnC0hZ3OeXHDcSTyurJwCg6LGXom7WKFmrVXRb1Ztcawu20YyI+nbbrznP3+D9crFuL3dLY6AAAAAElFTkSuQmCC) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/browse_icon.png?67c46) center right no-repeat!ie}#bodyContent span.smwmap a{padding-right:20px;color:#888888;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAANkE3LLaAgAAAzBJREFUOBGlwTtsGwUAgOH/zufHOe9zHBzsJM6DhpRUCWmjCiolKgOiS6VKrWBghSUswEAlJjYGRlQECypQhoIEAqlNuwSiJhSqkJAqbR40pnbjR/w6+x72+Xw+itgqMfF98D8JPCn2thwfDZ9/cXro7LOjfSflgLetpBoP1u9llm7/kbqirn+wyX/pmLz4wvsfXV9PplW30XBcu+m4dtNxrUbTNcyGu7r2sH72jc8/hHmJJwUm3pu79OUvVcO03ZJad1PpirtxL+3e2Uy5v24k3b1EwVWrlltW6+75hS++hgseHvPwjyPv9L72yuyNhddPhTXDIpEqki/p6GaDoOzlsKgjCCJOs4VmWBwd7T+2eDerGwdLqxKPdcltb710cnwgmVHJl3R2EjkkSaTVclG6g9hNh/HhPrySh939Am3BAPPHn7l4tfDuZQ+86RVD8scdbb6wLHvJ5quoWo1sQaOq1ckVdAajCqeOD2M3HBwHDgsGubwp7z3MbYn+8Z6oKAjDK+sJvrm+gVeSmBqP4TgumztZDrIauUONRKpMOqfRdFoUSzXUqondap3wBMJzMURhIRDwismMymC/wpn5CSaPRCiWDXp7giCIfHJllWLZJBLqolypc215i2yxui02/T7d5/PYlWqNnk6ZzZ00uw/yyD4fF85MMTsdY2RAQdOaJA+q5EsmZr2BZdv4vP6qx8nphtw/8qrfHwjrhoUousSjvcT6u7h5a4fFn7fJ5U062/y4Lgz1K+wk8rQQ+HN365IEa7aZ6f4+Mn3uaPJRlopmMRZXiD3dgW40qNUddMnCrNsc5FRUrYZhNUhnD0v1/a9uioBkZVcWq6WD0lg8Qme7TKVqIXqgL9TO2GAIBBerYeP3SeylcgRkmcz24lUwyx4gAM1uvZgkEp898fzkiNinyKzcSVBSTSLhDtqDPsJKO0NRhZCisPLTd3fVxLXPgLwHaAESzYqhZrfVztBQPBobaotGFGYmY4S62wkGZXqVbvb2s+6NHy7fytz/9lPgPpAR+JcE9AIDIE6MHzs9N3/65ZmZqeeeQhCkR+m8/vvab3vLSz8u62rqNvAXkAFqfwOkPI+h92xJFAAAAABJRU5ErkJggg==) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/world.png?0f0dd) center right no-repeat!ie}#bodyContent span.smwmap a:hover{padding-right:20px;color:#0000FF;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAANkE3LLaAgAAAzBJREFUOBGlwTtsGwUAgOH/zufHOe9zHBzsJM6DhpRUCWmjCiolKgOiS6VKrWBghSUswEAlJjYGRlQECypQhoIEAqlNuwSiJhSqkJAqbR40pnbjR/w6+x72+Xw+itgqMfF98D8JPCn2thwfDZ9/cXro7LOjfSflgLetpBoP1u9llm7/kbqirn+wyX/pmLz4wvsfXV9PplW30XBcu+m4dtNxrUbTNcyGu7r2sH72jc8/hHmJJwUm3pu79OUvVcO03ZJad1PpirtxL+3e2Uy5v24k3b1EwVWrlltW6+75hS++hgseHvPwjyPv9L72yuyNhddPhTXDIpEqki/p6GaDoOzlsKgjCCJOs4VmWBwd7T+2eDerGwdLqxKPdcltb710cnwgmVHJl3R2EjkkSaTVclG6g9hNh/HhPrySh939Am3BAPPHn7l4tfDuZQ+86RVD8scdbb6wLHvJ5quoWo1sQaOq1ckVdAajCqeOD2M3HBwHDgsGubwp7z3MbYn+8Z6oKAjDK+sJvrm+gVeSmBqP4TgumztZDrIauUONRKpMOqfRdFoUSzXUqondap3wBMJzMURhIRDwismMymC/wpn5CSaPRCiWDXp7giCIfHJllWLZJBLqolypc215i2yxui02/T7d5/PYlWqNnk6ZzZ00uw/yyD4fF85MMTsdY2RAQdOaJA+q5EsmZr2BZdv4vP6qx8nphtw/8qrfHwjrhoUousSjvcT6u7h5a4fFn7fJ5U062/y4Lgz1K+wk8rQQ+HN365IEa7aZ6f4+Mn3uaPJRlopmMRZXiD3dgW40qNUddMnCrNsc5FRUrYZhNUhnD0v1/a9uioBkZVcWq6WD0lg8Qme7TKVqIXqgL9TO2GAIBBerYeP3SeylcgRkmcz24lUwyx4gAM1uvZgkEp898fzkiNinyKzcSVBSTSLhDtqDPsJKO0NRhZCisPLTd3fVxLXPgLwHaAESzYqhZrfVztBQPBobaotGFGYmY4S62wkGZXqVbvb2s+6NHy7fytz/9lPgPpAR+JcE9AIDIE6MHzs9N3/65ZmZqeeeQhCkR+m8/vvab3vLSz8u62rqNvAXkAFqfwOkPI+h92xJFAAAAABJRU5ErkJggg==) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/world.png?0f0dd) center right no-repeat!ie}#bodyContent span.rdflink{float:right}#bodyContent span.rdflink a{padding-right:20px;color:#888888;background:url(data:image/gif;base64,R0lGODlhEQASAIQeAIWjzhpTo0h1tvH0+SpeqUh1tWeMwjlqr+Hp89Ld7cLR5rPG4RpSo8PS53aYyDhpr5Wv1FiBvO/z+KS62uDo8ileqWaMwXWXx7LF4KO62pSu1FeAu9Hc7P///wtHnQtHnSH+FUNyZWF0ZWQgd2l0aCBUaGUgR0lNUAAh+QQBAAAfACwAAAAAEQASAAAFU+AnjuQneKhQriclpSvJSC/qxaNX2/hn/6pY6udRAX03k82Y6dROJKjI01H8VknfDoXNbbmkougEBC+DZDES1aHAcChKZ9nzza89HbGefvfSDh8hADs=) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/rdf_flyer.18.gif?dc535) center right no-repeat!ie}#bodyContent span.rdflink a:hover{text-decoration:none;color:#0000FF;padding-right:20px;margin-right:0px;background:url(data:image/gif;base64,R0lGODlhEQASAIQeAIWjzhpTo0h1tvH0+SpeqUh1tWeMwjlqr+Hp89Ld7cLR5rPG4RpSo8PS53aYyDhpr5Wv1FiBvO/z+KS62uDo8ileqWaMwXWXx7LF4KO62pSu1FeAu9Hc7P///wtHnQtHnSH+FUNyZWF0ZWQgd2l0aCBUaGUgR0lNUAAh+QQBAAAfACwAAAAAEQASAAAFU+AnjuQneKhQriclpSvJSC/qxaNX2/hn/6pY6udRAX03k82Y6dROJKjI01H8VknfDoXNbbmkougEBC+DZDES1aHAcChKZ9nzza89HbGefvfSDh8hADs=) center right no-repeat;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/rdf_flyer.18.gif?dc535) center right no-repeat!ie} table.smwb-factbox{border-left:8px solid #DDDDDD;width:100% }tr.smwb-title{font-size:200%;background-color:#DDDDDD;line-height:1.5}tr.smwb-title td{padding-left:5px;border-bottom:2px solid white}tr.smwb-propvalue{width:100%;background-color:#EEEEEE}tr.smwb-propvalue th{text-align:right;vertical-align:top;font-weight:bold;font-size:120%;background-color:#DDDDDD;padding:0.2em 0.6em;border-bottom:2px solid white;border-top:2px solid white}tr.smwb-propvalue td{padding-left:0.4em;background-color:#EEEEEE;border:0px solid white;border-bottom:2px solid white;border-top:2px solid white;width:90%}tr.smwb-center{background-color:#DDDDDD}span.smwb-value{} table.smwb-ifactbox{border-right:8px solid #DDDDDD;width:100% }tr.smwb-ititle{font-size:200%;background-color:#DDDDDD;line-height:1.5}tr.smwb-ititle td{padding-left:5px;border-bottom:2px solid white}tr.smwb-ipropvalue{width:100%;background-color:#EEEEEE;text-align:right}tr.smwb-ipropvalue th{text-align:left;font-weight:bold;font-size:120%;background-color:#DDDDDD;padding:0.2em 0.6em;border-bottom:3px solid white;border-top:3px solid white}tr.smwb-ipropvalue td{background-color:#EEEEEE;border-bottom:3px solid white;border-top:3px solid white;padding-right:1em;width:90%}span.smwb-ivalue{} .smw-spinner .text{padding-left:2.1em;font-size:12px;vertical-align:middle} .smw-spinner.left.mw-small-spinner{background-position:left;vertical-align:middle;display:inline-block;padding:0px !important} .smw-spinner.center.mw-small-spinner{vertical-align:middle;display:inline-block;padding:0px !important} table.smw-ask-query .smw-ask-query-condition{width:100%}table.smw-ask-query .smw-ask-query-printout{width:100%}
div.smwtt{color:#000000} span.smwttpersist span.smwttcontent{color:#888888;font-style:italic;font-size:90%} span.smwttinline span.smwttcontent{display:none;speak:none} span.smwtticon{display:none} span.smwttactivepersist{cursor:help;color:#0000C8} span.smwttactiveinline{color:#BB7700;text-decoration:none} img.smwttimg{padding-right:5px;padding-left:4px} .smwttcontent{display:none} .smwtticon{padding:14px 12px 0 0;white-space:nowrap;margin-bottom:-1px} .smwtticon.info{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABmJLR0QAQACXAOIX6M4XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1woNCAQvupvvrgAAAgpJREFUKBUFwTtME3EAwOHf3f961+vd9Sh9HEVINUrFhAbRmCgGo9FodCFMLhomJ6MmJsbF1Z2ExMHBUQc3BmOigyERB0ElQHgECRYECrRC26OPa3t+nwQAAI7aO/K458yJeK8qOA74dY/1hbWdxZWJsVUoeAAKAImh2NDdR/duD54cdRLRdMQydB84KJaPzufyyx+6Tr+Zej/2jr1vBUHiin3j/pPnwzcvPMv0OKlb/YlAT4cupR1d0lRNNWwrmUhEB+tmSl7/vTktMiNPhy9dvviyM2FYnZEgpRp8WS3htaC/W2du64iWLAUl1RgoY84qiiJdU03TKFR9vv+tIZQGsiTojqg0WrDtwlHVR7PscCDAVaXoEV3KN+hCELUVVBFgNBOkXZd5NVPhoC6TL0J2v8FhnbiCUBtlX2WzInB1jZiuEQ4KfhVgrR7ErUO+UsMlgCwUT6FRW9YU2TdMXbIsjbglmD+EPQ9iYQFo1Go6Xq3c8hveolze2/hY3M6u2IaGHRI4JpxthyRVHAPCIQXbDFLcyi6WcuufhLs2lXMxsy0tkk51tDkdYVU6ZkosbFXxAwF290vN6amfM0uf374oTI5/lQAAYfddP5e58/BBuivel4qF4k0f/uy7u0sbubn5ifHX7srkLNCUAAAAQtFUW/LUQLI9HHGaPv6/Yj63s/pju1LYPAQA+A8p2cUweh5dZAAAAABJRU5ErkJggg==) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/info.png?34b97) no-repeat left bottom!ie}.smwtticon.service{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABmJLR0QAQACXAOIX6M4XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1woNCAQvupvvrgAAAgpJREFUKBUFwTtME3EAwOHf3f961+vd9Sh9HEVINUrFhAbRmCgGo9FodCFMLhomJ6MmJsbF1Z2ExMHBUQc3BmOigyERB0ElQHgECRYECrRC26OPa3t+nwQAAI7aO/K458yJeK8qOA74dY/1hbWdxZWJsVUoeAAKAImh2NDdR/duD54cdRLRdMQydB84KJaPzufyyx+6Tr+Zej/2jr1vBUHiin3j/pPnwzcvPMv0OKlb/YlAT4cupR1d0lRNNWwrmUhEB+tmSl7/vTktMiNPhy9dvviyM2FYnZEgpRp8WS3htaC/W2du64iWLAUl1RgoY84qiiJdU03TKFR9vv+tIZQGsiTojqg0WrDtwlHVR7PscCDAVaXoEV3KN+hCELUVVBFgNBOkXZd5NVPhoC6TL0J2v8FhnbiCUBtlX2WzInB1jZiuEQ4KfhVgrR7ErUO+UsMlgCwUT6FRW9YU2TdMXbIsjbglmD+EPQ9iYQFo1Go6Xq3c8hveolze2/hY3M6u2IaGHRI4JpxthyRVHAPCIQXbDFLcyi6WcuufhLs2lXMxsy0tkk51tDkdYVU6ZkosbFXxAwF290vN6amfM0uf374oTI5/lQAAYfddP5e58/BBuivel4qF4k0f/uy7u0sbubn5ifHX7srkLNCUAAAAQtFUW/LUQLI9HHGaPv6/Yj63s/pju1LYPAQA+A8p2cUweh5dZAAAAABJRU5ErkJggg==) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/info.png?34b97) no-repeat left bottom!ie}.smwtticon.warning{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAZ1JREFUKFOVy79rE3EcxvH39+7y8/q9pF4S0xi0mEiaMxV68Yxg8PeiVyhV6iCIQhErHUScFJxcHAX/Azf/AgWXWlsUhyrYioMiqKgoiEgrJTH3cSuldvE9Pg8vkw3Nt6lfHuZ68g9fnv/k2/pPRDDWD098bD1gTO4cdS+NNowp38ZhQ2tgZgQSWo3kDgyPpU/esSuHd4fnK6o1lERtCuIp0tmGO73sHavevf8B8Y7uaDT7pwMXvSmwEkbgNHeFb1eLPH22wNJKnka7enxAG+1/wKxPpq+SuuaeOKSzuSQxq0vGjZML99vj+xJXDmoKa2DOx0znOVUcL7fNrXl8v0OtZhIEv1GFFLUJt3XW43TRJAZgGBal/lbsjN0sZeENIkuEoQUsAq/RQcZpHjEnzpUpA/DqAld/zOjVqOdJFO2RuXlPhuo5efBwUKJou0S9gvx6HO/cG+OmiGD1FdSU3tZNyNdPAFQd4cbFHvUty8jnCOhhl6JYfZBJ4JY1+1IeObc770S6ChClQCvhxaKwEAEISqE+vuf7XkCJCP/TX7cEexPi9whUAAAAAElFTkSuQmCC) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/warning.png?06a3c) no-repeat left bottom!ie}.smwtticon.note{display:inline-block;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgtJREFUeNokUctqU1EUXefk5iY3D2MrSWOamyq9jYO2BovUR41O1Iykov6Bc6WDDh36A4oKnYkORZBCoA6KI1GrEKhoFWOo1qhJk6Z539c57sTB5gzOWns9NpMA3KCK0s0TsHwiBsW3qPi0OYerbmP89IaVnFvtMn/dmEginU5DITyYLSA4y40embp3MDWVVoNhgKvot1sob699/OqdvM0MY32AVTrZWZhhfnEsk85HEikOxoERnbYwBLxeGNH4jK/wdq1W1Bd7h8fySnlei4WT0ZV4ROWivQt4A+AzV0DrIV8/AtQA9Onjyt7G6spmOJHhb6IXrkbCnqOyuw+YNL0aTRPSpOnVidgE7A70Q/7x+pf315Wgph1TpAVBOcApktUBnN7/t9/AoBT6REAl8f3dBcW07R1pdSGkSvaJIBzIWpHUWkRqDrNAWENFIWJBZafWKZgjbWghDZIRgUK7Hx4PugNzXSK1wZmLVq0CO5ot8kw2Vyg70U+M/Eu7D0lWPLm78GSXKEOD7JlAu4rvTVWwmPGc/frzF63S5kIgv7SeOGCp0usHUmfAhAtW3SIdga2ffZTnl++nZk/dYlJKkDBePXtyOfb56cO4W5rUWH9YQEcEsI2U+9u48WD63KVlY0K3hpeWjgMxqr+snr9zslL5do3t/ThLnYXsUKLIY8YLj22+Y441gOKfAAMAeeDgUIIDAXwAAAAASUVORK5CYII=) no-repeat left bottom;background:url(https://rosettacode.org/mw/extensions/SemanticMediaWiki/resources/images/note.png?3c504) no-repeat left bottom!ie}</style><style>
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
textarea{font-family:Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace}.ti89b{font-family:'TI Uni',monospace}.wikicode{font-weight:bold} .kw1{font-weight:bold;color:#0000ff}.kw2{font-weight:bold;color:#0000cc}.kw3{font-weight:bold;color:#3333cc}.kw4{font-weight:bold;color:#6666cc}.kw5{font-weight:bold;color:#9999cc}.br0{font-weight:bold;color:#009900}.nu0{font-weight:bold;color:#009999}.co1{color:#666666;font-style:italic}.co2{font-weight:bold;color:#666666;font-style:italic}.coMULTI{font-weight:bold;color:#666;font-style:italic}.me1{font-weight:bold;color:#993399}.me2{font-weight:bold;color:#cc66cc}.st0,.st_h{color:#ff0000} .re2{background-color:#ccccff}.re3{background-color:#ffcccc} #p-googleadsense .pBody{padding-top:5px;text-align:center} ol.references > li:target{background-color:#DEF} table.wikitable,table.prettytable{margin:1em 1em 1em 0;background:#f9f9f9;border:1px #aaa solid;border-collapse:collapse}table.wikitable th,table.wikitable td,table.prettytable th,table.prettytable td{border:1px #aaa solid;padding:0.2em}table.wikitable th,table.prettytable th{background:#f2f2f2;text-align:center}table.wikitable caption,table.prettytable caption{margin-left:inherit;margin-right:inherit;font-weight:bold} table.navbox{background-color:#f9f9f9;border:1px solid #aaa;clear:both;font-size:90%;margin:1em 0em 0em;padding:5px;text-align:center;width:100%}table.navbox th{background-color:#ccf;padding-left:1em;padding-right:1em}table.navbox tr:not(:first-child) th{background-color:#ddf}@media print{.navbox{display:none}} .infobox{border:1px solid #aaa;background-color:#f9f9f9;color:black;margin-bottom:0.5em;margin-left:1em;padding:0.2em;float:right;clear:right}.infobox td,.infobox th{vertical-align:top}.infobox caption{font-size:larger;margin-left:inherit}.infobox.bordered{border-collapse:collapse}.infobox.bordered td,.infobox.bordered th{border:1px solid #aaa}.infobox.bordered .borderless td,.infobox.bordered .borderless th{border:0}.infobox.sisterproject{width:20em;font-size:90%}@media print{.infobox.sisterproject{display:none}} .infobox.bordered .mergedtoprow td,.infobox.bordered .mergedtoprow th{border:0;border-top:1px solid #aaa;border-right:1px solid #aaa}.infobox.bordered .mergedrow td,.infobox.bordered .mergedrow th{border:0;border-right:1px solid #aaa}#disambig{border-top:1px solid #ccc;border-bottom:1px solid #ccc} .Talk-Notice{border:1px solid #C0C090;background-color:#F8EABA;margin-bottom:3px;width:85%;border-spacing:3px;margin-left:auto;margin-right:auto}.Talk-Notice:after{content:"The CSS for this template should be changed. See [[Wikipedia:Template Standardisation]]."} .Talk-Notice td{background:inherit} table.persondata{border:1px solid #aaa;display:none;speak:none}.persondata-label{color:#aaa} .allpagesredirect{font-style:italic}  .Use_Default_Date_Convention{display:inline}.Use_AD_and_BC{display:none}.Use_BCE_and_CE{display:none}     .audiolink a{background:url(http://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/Loudspeaker.svg/11px-Loudspeaker.svg.png) center left no-repeat !important;padding-left:16px !important;padding-right:0 !important} div.listenlist{background:url(http://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Gnome-speakernotes.png/30px-Gnome-speakernotes.png);padding-left:40px}div.videolist,div.multivideolist{background:url(http://upload.wikimedia.org/wikipedia/en/thumb/2/20/Tango-video-x-generic.png/40px-Tango-video-x-generic.png);padding-left:50px} div.medialist{min-height:50px;margin:1em;background-position:top left;background-repeat:no-repeat}div.medialist ul{list-style-type:none;list-style-image:none;margin:0}div.medialist ul li{padding-bottom:0.5em}div.medialist ul li li{font-size:91%;padding-bottom:0}  #bodyContent a[href$=".pdf"].external,#bodyContent a[href*=".pdf?"].external,#bodyContent a[href*=".pdf#"].external,#bodyContent a[href$=".PDF"].external,#bodyContent a[href*=".PDF?"].external,#bodyContent a[href*=".PDF#"].external{background:url(http://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Icons-mini-file_acrobat.gif/15px-Icons-mini-file_acrobat.gif) center right no-repeat;padding-right:16px}  span.PDFlink a{background:url(http://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Icons-mini-file_acrobat.gif/15px-Icons-mini-file_acrobat.gif) center right no-repeat !important;padding-right:17px !important} div.columns-2 div.column{float:left;width:50%;min-width:300px}div.columns-3 div.column{float:left;width:33.3%;min-width:200px}div.columns-4 div.column{float:left;width:25%;min-width:150px}div.columns-5 div.column{float:left;width:20%;min-width:120px} .plainlinksneverexpand{background:none ! important;padding:0 ! important}.plainlinksneverexpand .urlexpansion{display:none ! important} .plainlinksneverexpand a{background:none !important;padding:0 !important} .plainlinksneverexpand a.external.text:after{display:none !important}.plainlinksneverexpand a.external.autonumber:after{display:none !important} .messagebox{border:1px solid #aaa;background-color:#f9f9f9;width:80%;margin:0 auto 1em auto;padding:.2em}.messagebox.merge{border:1px solid #c0b8cc;background-color:#f0e5ff;text-align:center}.messagebox.cleanup{border:1px solid #9f9fff;background-color:#efefff;text-align:center}.messagebox.standard-talk{border:1px solid #c0c090;background-color:#f8eaba}.messagebox.taskdescription{border:1px solid #3333ff;background-color:#9999ff;text-align:center} #file img{background:url(http://upload.wikimedia.org/wikipedia/commons/5/5d/Checker-16x16.png) repeat} .IPA{font-family:"Chrysanthi Unicode","Doulos SIL",Gentium,GentiumAlt,Code2000,"TITUS Cyberbit Basic","DejaVu Sans","Bitstream Cyberbit","Arial Unicode MS","Lucida Sans Unicode","Hiragino Kaku Gothic Pro","Matrix Unicode";font-family :inherit}.Unicode{font-family:Code2000,"TITUS Cyberbit Basic","Doulos SIL","Chrysanthi Unicode","Bitstream Cyberbit","Bitstream CyberBase",Thryomanes,Gentium,GentiumAlt,"Lucida Grande","Arial Unicode MS","Microsoft Sans Serif","Lucida Sans Unicode";font-family :inherit}.latinx{font-family:Code2000,"TITUS Cyberbit Basic","Microsoft Sans Serif";font-family :inherit}.polytonic{font-family:Athena,Gentium,"Palatino Linotype","Arial Unicode MS","Lucida Sans Unicode","Lucida Grande",Code2000;font-family :inherit}.mufi{font-family:Alphabetum,Cardo,LeedsUni,Junicode,"TITUS Cyberbit Basic",ALPHA-Demo}#wpSave{font-weight:bold} .hiddenStructure{display:inline ! important;color:#f00;background-color:#0f0} .nounderlines a{text-decoration:none} .IPA a:link,.IPA a:visited{text-decoration:none} @media print{#privacy,#about,#disclaimer{display:none}}#EnWpMpBook{background-image:url(http://upload.wikimedia.org/wikipedia/en/7/7e/MP-open-book.png)}#EnWpMpSearch{background:url(http://upload.wikimedia.org/wikipedia/en/a/ae/MP-magnifying-glass.png) no-repeat top right}#EnWpMpSearchInner{float:right;width:20em;text-align:center}#EnWpMpBook2{background-image:url(http://upload.wikimedia.org/wikipedia/commons/8/8e/MP-open-book2.png)}.messagebox.small-talk{width:238px;font-size:85%;float:right;clear:both;margin:0 0 1em 1em;line-height:1.25em;background:#F8EABA} div.Boxmerge,div.NavFrame{margin:0px;padding:2px;border:1px solid #aaa;text-align:center;border-collapse:collapse;font-size:95%}div.Boxmerge div.NavFrame{border-style:none;border-style:hidden}div.NavFrame + div.NavFrame{border-top-style:none;border-top-style:hidden}div.NavPic{background-color:#fff;margin:0px;padding:2px;float:left}div.NavFrame div.NavHead{height:1.6em;font-weight:bold;font-size:100%;background-color:#efefef;position:relative}div.NavFrame p{font-size:100%}div.NavFrame div.NavContent{font-size:100%}div.NavFrame div.NavContent p{font-size:100%}div.NavEnd{margin:0px;padding:0px;line-height:1px;clear:both}a.NavToggle{position:absolute;top:0px;right:3px;font-weight:normal;font-size:smaller} .mw-plusminus-pos{color:darkgreen} .mw-plusminus-neg{color:darkred}.dablink{font-style:italic;padding-left:2em}pre{overflow:auto}
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(https://rosettacode.org/mw/resources/src/mediawiki.action/images/green-checkmark.png?9048a)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="./totp_files/load(1).php">
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="./totp_files/load(2).php" type="text/javascript"></script>
<meta name="generator" content="MediaWiki 1.26.2">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="ExportRDF" type="application/rdf+xml" title="Time-based one-time password algorithm" href="https://rosettacode.org/mw/index.php?title=Special:ExportRDF/Time-based_one-time_password_algorithm&amp;xmlmime=rdf">
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit">
<link rel="edit" title="Edit" href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit">
<link rel="shortcut icon" href="https://rosettacode.org/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://rosettacode.org/mw/opensearch_desc.php" title="Rosetta Code (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://rosettacode.org/mw/api.php?action=rsd">
<link rel="copyright" href="https://www.gnu.org/licenses/fdl-1.2.html">
<link rel="alternate" type="application/atom+xml" title="Rosetta Code Atom feed" href="https://rosettacode.org/mw/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="canonical" href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm">
<script src="./totp_files/load(3).php"></script></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Time-based_one-time_password_algorithm layout-standard skin-chameleon action-view">
<div class="container">
<div class="row">
<div class="col-lg-3">

<div id="p-logo" class="p-logo" role="banner">
<a href="https://rosettacode.org/wiki/Rosetta_Code" title="Visit the main page"><img src="./totp_files/title.png" alt="Rosetta Code"></a>
</div>
</div>
<div class="col-lg-9">
<div class="row">
<div class="col-lg-12">

<div class="p-personal pull-right" id="p-personal">
<ul class="p-personal-tools list-inline pull-right">
<li id="pt-createaccount"><a href="https://rosettacode.org/mw/index.php?title=Special:UserLogin&amp;returnto=Time-based+one-time+password+algorithm&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
<li id="pt-login"><a href="https://rosettacode.org/mw/index.php?title=Special:UserLogin&amp;returnto=Time-based+one-time+password+algorithm" title="You are encouraged to log in; however, it is not mandatory [alt-shift-o]" accesskey="o">Log in</a></li>
</ul>
<div class="newtalk-notifier">
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<div id="p-search" class="p-search pull-right" role="search">
<form id="searchform" class="mw-search form-inline" action="https://rosettacode.org/mw/index.php">
<input type="hidden" name="title" value="Special:Search">
<div class="input-group">
<input name="search" placeholder="Search" title="Search Rosetta Code [alt-shift-f]" accesskey="f" id="searchInput" class="form-control" autocomplete="off">
<div class="input-group-btn">
<button value="Go" id="searchGoButton" name="go" title="Go to a page with this exact name if it exists" type="submit" class="searchGoButton btn btn-default"><span class="glyphicon glyphicon-share-alt"></span></button><button value="Search" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" class="mw-searchButton btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
</div>
</div>
</form>
</div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<nav class="navbar navbar-default p-navbar" role="navigation" id="mw-navigation">
<div class="container-fluid"><div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mw-navigation-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
</div>
<div class="collapse navbar-collapse" id="mw-navigation-collapse"><ul class="nav navbar-nav">

<li class="dropdown">
<a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
<ul class="dropdown-menu p-Community" id="p-Community">
<li id="n-Twitter"><a href="https://twitter.com/rosettacode" rel="nofollow">Twitter</a></li>
<li id="n-Chat.2FIRC"><a href="https://rosettacode.org/wiki/Special:WebChat">Chat/IRC</a></li>
<li id="n-Planet"><a href="https://rosettacode.org/planet" rel="nofollow">Planet</a></li>
<li id="n-The-Village-Pump"><a href="https://rosettacode.org/wiki/Rosetta_Code:Village_Pump">The Village Pump</a></li>
<li id="n-Finances"><a href="https://rosettacode.org/wiki/Rosetta_Code:Finances">Finances</a></li>
</ul>
</li>

<li class="dropdown">
<a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#" class="dropdown-toggle" data-toggle="dropdown">Explore <b class="caret"></b></a>
<ul class="dropdown-menu p-Explore" id="p-Explore">
<li id="n-Languages"><a href="https://rosettacode.org/wiki/Category:Programming_Languages">Languages</a></li>
<li id="n-Tasks"><a href="https://rosettacode.org/wiki/Category:Programming_Tasks">Tasks</a></li>
<li id="n-recentchanges"><a href="https://rosettacode.org/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent changes</a></li>
<li id="n-Similar-sites"><a href="https://rosettacode.org/wiki/Help:Similar_Sites">Similar sites</a></li>
<li id="n-randompage"><a href="https://rosettacode.org/wiki/Special:Random" title="Load a random page [alt-shift-x]" accesskey="x">Random page</a></li>
</ul>
</li></ul>
</div>
</div>
</nav>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<ul class="p-contentnavigation list-inline text-center" id="p-contentnavigation">

<li id="p-namespaces">
<ul class="list-inline">
<li id="ca-nstab-main" class="selected"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm" title="View the content page [alt-shift-c]" accesskey="c" class="selected">Page</a></li>
<li id="ca-talk" class="new"><a href="https://rosettacode.org/mw/index.php?title=Talk:Time-based_one-time_password_algorithm&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [alt-shift-t]" accesskey="t" class="new">Discussion</a></li>
</ul>
</li>

<li id="p-views">
<ul class="list-inline">
<li id="ca-edit"><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit" title="Edit this page [alt-shift-e]" accesskey="e">Edit</a></li>
<li id="ca-history"><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=history" title="Past revisions of this page [alt-shift-h]" accesskey="h">History</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<div id="siteNotice" class="siteNotice "><div id="localNotice" lang="en" dir="ltr"><table class="messagebox" style="text-align: center; background-color: lightyellow; clear: both;">
<tbody><tr>
<td> <b>I'm working on modernizing Rosetta Code's infrastructure. Starting with communications. Please accept <a rel="nofollow" class="external text" href="https://join.slack.com/t/rosettacode/shared_invite/zt-glwmugtu-xpMPcqHs0u6MsK5zCmJF~Q">this time-limited open invite to RC's Slack.</a>. --<a href="https://rosettacode.org/wiki/User:Short_Circuit" title="User:Short Circuit">Michael Mol</a> (<a href="https://rosettacode.org/wiki/User_talk:Short_Circuit" title="User talk:Short Circuit">talk</a>) 20:59, 30 May 2020 (UTC)</b>
</td></tr></tbody></table>
</div></div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<div id="content" class="mw-body"><a id="top"></a>
<div id="mw-js-message" style="display:none;"></div>
<div class="contentHeader">

<h1 id="firstHeading" class="firstHeading">Time-based one-time password algorithm</h1>

<div id="siteSub">From Rosetta Code</div>

<div id="contentSub" class="small"><span class="mw-redirectedfrom">(Redirected from <a href="https://rosettacode.org/mw/index.php?title=Time-based_One-time_Password_Algorithm&amp;redirect=no" title="Time-based One-time Password Algorithm">Time-based One-time Password Algorithm</a>)</span></div><div id="jump-to-nav" class="mw-jump">Jump to:<a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#mw-navigation">navigation</a>, <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#p-search">search</a></div>
</div><div id="bodyContent">

<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="infobox" style="width: 2in"><i> <b>Time-based one-time password algorithm</b> </i> is a <b>draft</b> programming task. It is not yet considered ready to be promoted as a complete task, for reasons that should be found in its <a href="https://rosettacode.org/mw/index.php?title=Talk:Time-based_one-time_password_algorithm&amp;action=edit&amp;redlink=1" class="new" title="Talk:Time-based one-time password algorithm (page does not exist)">talk page</a>.</div>
<table align="center" border="0" cellpadding="3" cellspacing="3" style="border: 1px solid #E0E0E0; background-color: #F8F8F8; color:black;">
<tbody><tr>
<td style="font-size: 90%"> This page uses content from <b><a rel="nofollow" class="external text" href="https://en.wikipedia.org/">Wikipedia</a></b>. The original article was at <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Time-based_one-time_password_algorithm">Time-based one-time password algorithm</a>. The list of authors can be seen in the <a rel="nofollow" class="external text" href="https://en.wikipedia.org/w/index.php?title=Time-based_one-time_password_algorithm&amp;action=history"><b>page history</b></a>. <a href="https://rosettacode.org/wiki/Rosetta_Code:Copyrights" title="Rosetta Code:Copyrights">As with Rosetta Code</a>, the text of Wikipedia <a href="https://en.wikipedia.org/wiki/Project:Copyrights" class="extiw" title="wp:Project:Copyrights">is available</a> under the <a rel="nofollow" class="external text" href="https://www.gnu.org/licenses/fdl.html">GNU FDL</a>. (See links for details on variance)
</td></tr></tbody></table>
<p><br>
A Time-based One-time Password Algorithm (TOTP) is an algorithm that computes a one-time password from a shared secret key and the current time. It is the cornerstone of <a href="https://en.wikipedia.org/wiki/Initiative_For_Open_Authentication" class="extiw" title="wp:Initiative For Open Authentication">Initiative For Open Authentication (OATH)</a> and is used in a number of two factor authentication systems.
</p><p>Essentially, both the server and the client compute the time-limited token, then the server checks if the token supplied by the client matches the locally generated token.
</p><p><br>
</p>
<dl><dt>Task</dt>
<dd></dd></dl>
<p>Implement this algorithm using <b>HMAC-SHA1</b> and an optional step is to generate the random <a href="https://en.wikipedia.org/wiki/Base32" class="extiw" title="wp:Base32">Base-32</a> string used as the secret key, but this is not a requirement.
</p><p>A reference implementation, based on JavaScript, can be found at the following location:
</p>
<dl><dd><dl><dd><dl><dd> <a rel="nofollow" class="external free" href="http://blog.tinisles.com/2011/10/google-authenticator-one-time-password-algorithm-in-javascript">http://blog.tinisles.com/2011/10/google-authenticator-one-time-password-algorithm-in-javascript</a></dd></dl></dd></dl></dd></dl>
<p><br>
According to <a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc6238">RFC 6238</a>, the reference implementation is as follows:
</p>
<ul><li> &nbsp; Generate a key, <b>K</b>, which is an arbitrary bytestring, and share it securely with the client.</li>
<li>&nbsp; Agree upon an epoch, T0, and an interval, TI, which will be used to calculate the value of the counter C (defaults are the Unix epoch as T0 and 30 seconds as TI)</li>
<li> &nbsp; Agree upon a cryptographic hash method (default is SHA-1)</li>
<li> &nbsp; Agree upon a token length, <b>N</b> (default is 6)</li></ul>
<p><br>
Although <a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc6238">RFC 6238</a> allows different parameters to be used, the Google implementation of the authenticator app does not support T0, TI values, hash methods and token lengths different from the default. &nbsp; It also expects the <b>K</b> secret key to be entered (or supplied in a QR code) in base-32 encoding according to <a class="external mw-magiclink-rfc" rel="nofollow" href="https://tools.ietf.org/html/rfc3548">RFC 3548</a>.
</p>
<ul><li> &nbsp; <a rel="nofollow" class="external text" href="https://itunes.apple.com/gb/app/google-authenticator/id388497605">Google Authenticator App (Apple iOS)</a></li>
<li> &nbsp; <a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">Google Authenticator App (Google Android)</a></li>
<li> &nbsp; <a rel="nofollow" class="external text" href="https://www.windowsphone.com/en-us/store/app/authenticator/e7994dbc-2336-4950-91ba-ca22d653759b">Microsoft Authenticator App (Windows Phone)</a></li></ul>
<p><br><br>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#C.23"><span class="tocnumber">1</span> <span class="toctext">C#</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Cach.C3.A9_ObjectScript"><span class="tocnumber">2</span> <span class="toctext">Cach√© ObjectScript</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Go"><span class="tocnumber">3</span> <span class="toctext">Go</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Julia"><span class="tocnumber">4</span> <span class="toctext">Julia</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Nim"><span class="tocnumber">5</span> <span class="toctext">Nim</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Perl"><span class="tocnumber">6</span> <span class="toctext">Perl</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Phix"><span class="tocnumber">7</span> <span class="toctext">Phix</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#PicoLisp"><span class="tocnumber">8</span> <span class="toctext">PicoLisp</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Racket"><span class="tocnumber">9</span> <span class="toctext">Racket</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Raku"><span class="tocnumber">10</span> <span class="toctext">Raku</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Tcl"><span class="tocnumber">11</span> <span class="toctext">Tcl</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Wren"><span class="tocnumber">12</span> <span class="toctext">Wren</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#zkl"><span class="tocnumber">13</span> <span class="toctext">zkl</span></a></li>
</ul>
</div>
<h2><span class="mw-headline" id="C.23"><a href="https://rosettacode.org/wiki/Category:C_sharp" title="Category:C sharp">C#</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=1" title="Edit section: C#">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="csharp highlighted_source"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span><br><span class="kw1">using</span> <span class="co3">System.Security.Cryptography</span><span class="sy0">;</span><br>&nbsp;<br><span class="kw1">namespace</span> RosettaTOTP<br><span class="br0">{</span><br>    <span class="kw1">public</span> <span class="kw4">class</span> TOTP_SHA1<br>    <span class="br0">{</span><br>        <span class="kw1">private</span> <span class="kw4">byte</span><span class="br0">[</span><span class="br0">]</span> K<span class="sy0">;</span><br>        <span class="kw1">public</span> TOTP_SHA1<span class="br0">(</span><span class="br0">)</span><br>        <span class="br0">{</span><br>            GenerateKey<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br>        <span class="br0">}</span><br>        <span class="kw1">public</span> <span class="kw4">void</span> GenerateKey<span class="br0">(</span><span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw1">using</span> <span class="br0">(</span>RandomNumberGenerator rng <span class="sy0">=</span> <a href="https://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> RNGCryptoServiceProvider<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>            <span class="br0">{</span><br>                <span class="coMULTI">/*    Keys SHOULD be of the length of the HMAC output to facilitate<br>                      interoperability.*/</span><br>                K <span class="sy0">=</span> <a href="https://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="kw4">byte</span><span class="br0">[</span>HMACSHA1<span class="sy0">.</span><span class="me1">Create</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">HashSize</span> <span class="sy0">/</span> <span class="nu0">8</span><span class="br0">]</span><span class="sy0">;</span><br>                rng<span class="sy0">.</span><span class="me1">GetBytes</span><span class="br0">(</span>K<span class="br0">)</span><span class="sy0">;</span><br>            <span class="br0">}</span><br>        <span class="br0">}</span><br>        <span class="kw1">public</span> <span class="kw4">int</span> HOTP<span class="br0">(</span>UInt64 C, <span class="kw4">int</span> digits <span class="sy0">=</span> <span class="nu0">6</span><span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw1">var</span> hmac <span class="sy0">=</span> HMACSHA1<span class="sy0">.</span><span class="me1">Create</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br>            hmac<span class="sy0">.</span><span class="me1">Key</span> <span class="sy0">=</span> K<span class="sy0">;</span><br>            hmac<span class="sy0">.</span><span class="me1">ComputeHash</span><span class="br0">(</span>BitConverter<span class="sy0">.</span><span class="me1">GetBytes</span><span class="br0">(</span>C<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br>            <span class="kw1">return</span> Truncate<span class="br0">(</span>hmac<span class="sy0">.</span><span class="me1">Hash</span>, digits<span class="br0">)</span><span class="sy0">;</span><br>        <span class="br0">}</span><br>        <span class="kw1">public</span> UInt64 CounterNow<span class="br0">(</span><span class="kw4">int</span> T1 <span class="sy0">=</span> <span class="nu0">30</span><span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw1">var</span> secondsSinceEpoch <span class="sy0">=</span> <span class="br0">(</span>DateTime<span class="sy0">.</span><span class="me1">UtcNow</span> <span class="sy0">-</span> <a href="https://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> DateTime<span class="br0">(</span><span class="nu0">1970</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, DateTimeKind<span class="sy0">.</span><span class="me1">Utc</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">TotalSeconds</span><span class="sy0">;</span><br>            <span class="kw1">return</span> <span class="br0">(</span>UInt64<span class="br0">)</span>Math<span class="sy0">.</span><span class="me1">Floor</span><span class="br0">(</span>secondsSinceEpoch <span class="sy0">/</span> T1<span class="br0">)</span><span class="sy0">;</span><br>        <span class="br0">}</span><br>        <span class="kw1">private</span> <span class="kw4">int</span> DT<span class="br0">(</span><span class="kw4">byte</span><span class="br0">[</span><span class="br0">]</span> hmac_result<span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw4">int</span> offset <span class="sy0">=</span> hmac_result<span class="br0">[</span><span class="nu0">19</span><span class="br0">]</span> <span class="sy0">&amp;</span> 0xf<span class="sy0">;</span><br>            <span class="kw4">int</span> bin_code <span class="sy0">=</span> <span class="br0">(</span>hmac_result<span class="br0">[</span>offset<span class="br0">]</span> <span class="sy0">&amp;</span> 0x7f<span class="br0">)</span> <span class="sy0">&lt;&lt;</span> <span class="nu0">24</span><br>               <span class="sy0">|</span> <span class="br0">(</span>hmac_result<span class="br0">[</span>offset <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">]</span> <span class="sy0">&amp;</span> 0xff<span class="br0">)</span> <span class="sy0">&lt;&lt;</span> <span class="nu0">16</span><br>               <span class="sy0">|</span> <span class="br0">(</span>hmac_result<span class="br0">[</span>offset <span class="sy0">+</span> <span class="nu0">2</span><span class="br0">]</span> <span class="sy0">&amp;</span> 0xff<span class="br0">)</span> <span class="sy0">&lt;&lt;</span> <span class="nu0">8</span><br>               <span class="sy0">|</span> <span class="br0">(</span>hmac_result<span class="br0">[</span>offset <span class="sy0">+</span> <span class="nu0">3</span><span class="br0">]</span> <span class="sy0">&amp;</span> 0xff<span class="br0">)</span><span class="sy0">;</span><br>            <span class="kw1">return</span> bin_code<span class="sy0">;</span><br>        <span class="br0">}</span><br>&nbsp;<br>        <span class="kw1">private</span> <span class="kw4">int</span> Truncate<span class="br0">(</span><span class="kw4">byte</span><span class="br0">[</span><span class="br0">]</span> hmac_result, <span class="kw4">int</span> digits<span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw1">var</span> Snum <span class="sy0">=</span> DT<span class="br0">(</span>hmac_result<span class="br0">)</span><span class="sy0">;</span><br>            <span class="kw1">return</span> Snum <span class="sy0">%</span> <span class="br0">(</span><span class="kw4">int</span><span class="br0">)</span>Math<span class="sy0">.</span><span class="me1">Pow</span><span class="br0">(</span><span class="nu0">10</span>, digits<span class="br0">)</span><span class="sy0">;</span><br>        <span class="br0">}</span><br>    <span class="br0">}</span><br>&nbsp;<br>&nbsp;<br>    <span class="kw4">class</span> Program<br>    <span class="br0">{</span><br>        <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">(</span><span class="kw4">string</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span><br>        <span class="br0">{</span><br>            <span class="kw1">var</span> totp <span class="sy0">=</span> <a href="https://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> TOTP_SHA1<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br>            Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">(</span>totp<span class="sy0">.</span><span class="me1">HOTP</span><span class="br0">(</span>totp<span class="sy0">.</span><span class="me1">CounterNow</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br>        <span class="br0">}</span><br>    <span class="br0">}</span><br><span class="br0">}</span><br>&nbsp;</pre>
<h2><span class="mw-headline" id="Cach.C3.A9_ObjectScript"><a href="https://rosettacode.org/wiki/Category:Cach%C3%A9_ObjectScript" title="Category:Cach√© ObjectScript">Cach√© ObjectScript</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=2" title="Edit section: Cach√© ObjectScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="text highlighted_source">&nbsp;<br>Class Utils.Security [ Abstract ]<br>{<br>&nbsp;<br>ClassMethod GetOTP(b32secret As&nbsp;%String) As&nbsp;%String<br>{<br>	// convert base32 secret into string<br>	Set key=..B32ToStr(b32secret)<br>&nbsp;<br>	// get the unix time, divide by 30 and convert into eight-byte string<br>	Set epoch=..GetUnixTime()<br>	Set val=$Reverse($ZQChar(epoch\30))<br>&nbsp;<br>	// compute the HMAC SHA-1 hash and get the last nibble...<br>	Set hmac=$System.Encryption.HMACSHA1(val, key)<br>	Set last=$ASCII($Extract(hmac, *))<br>&nbsp;<br>	// calculate the offset and get one-time password string<br>	Set offset=$ZBoolean(last, $Char(15), 1)  // logical 'AND' operation<br>	Set otpstr=$ZBoolean($Extract(hmac, offset+1, offset+4), $Char(127,255,255,255), 1)<br>&nbsp;<br>	// convert string into decimal and return last six digits<br>	Set otpdec=$ZLASCII($Reverse(otpstr))<br>	Quit ..LeftPad(otpdec, 6)<br>}<br>&nbsp;<br>ClassMethod GetUnixTime() As&nbsp;%Integer [ Private ]<br>{<br>	// current date and time in UTC time format<br>	Set now=$ZTimeStamp<br>	Set daydiff=(now - $ZDateH("1970-01-01", 3))<br>	Set secs=$Piece(now, ",", 2)\1<br>	Quit (daydiff*60*60*24)+secs<br>}<br>&nbsp;<br>ClassMethod LeftPad(str As&nbsp;%String, len As&nbsp;%Integer, pad As&nbsp;%String = 0) As&nbsp;%String [ Private ]<br>{<br>	Quit $Extract($Translate($Justify(str, len), " ", pad), *-(len-1), *)<br>}<br>&nbsp;<br>ClassMethod ConvertBase10ToN(pNum As&nbsp;%Integer = "", pBase As&nbsp;%Integer = "", pBaseStr As&nbsp;%String = "", pPos As&nbsp;%Integer = 0) As&nbsp;%String [ Private ]<br>{<br>	If pNum=0 Quit ""<br>	Set str=..ConvertBase10ToN(pNum\pBase, pBase, pBaseStr, pPos+1)<br>	Quit str_$Extract(pBaseStr, pNum#pBase+1)<br>}<br>&nbsp;<br>ClassMethod ConvertBaseNTo10(pStr As&nbsp;%String = "", pBase As&nbsp;%Integer = "", pBaseStr As&nbsp;%String = "", pPos As&nbsp;%Integer = 0) As&nbsp;%Integer [ Private ]<br>{<br>	If pStr="" Quit 0<br>	Set num=..ConvertBaseNTo10($Extract(pStr, 1, *-1), pBase, pBaseStr, pPos+1)<br>	Set dec=$Find(pBaseStr, $Extract(pStr, *))-2<br>	Quit num+(dec*(pBase**pPos))<br>}<br>&nbsp;<br>ClassMethod B32ToStr(b32str As&nbsp;%String) As&nbsp;%String [ Private ]<br>{<br>	Set b32str=$ZConvert(b32str,"U")<br>	Set b32alp="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"<br>	Set (bits,str)=""<br>	For i=1:1:$Length(b32str) {<br>		Set val=$Find(b32alp, $Extract(b32str, i))-2<br>		Set bits=bits_..LeftPad(..ConvertBase10ToN(val, 2, "01"), 5)<br>	}<br>	For i=1:8:$Length(bits) {<br>		Set chunk=$Extract(bits, i, i+7)<br>		Set str=str_$Char(..ConvertBaseNTo10(chunk, 2, "01"))<br>	}<br>	Quit str<br>}<br>&nbsp;<br>ClassMethod GenerateSecret() As&nbsp;%String<br>{<br>	// initialise base 32 string and alphabet<br>	Set b32str="", b32alp="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"<br>&nbsp;<br>	// build a large base 32 string<br>	For pass=1:1:4 {<br>		Set b32str=b32str_..ConvertBase10ToN($System.Encryption.GenCryptToken(), 32, b32alp)<br>	}<br>&nbsp;<br>	// return randomly generated password<br>	Quit ..LeftPad(b32str, 16)<br>}<br>&nbsp;<br>}<br>&nbsp;</pre>
<div>
<dl><dt>Example:</dt></dl></div>
<pre>DEMO&gt;for i=1:1:5 write ##class(Utils.Security).GetOTP("JBSWY3DPEHPK3PXP"),! hang 15  // wait fifteen seconds
992374
992374
169898
169898
487462

DEMO&gt;write ##class(User.View.Security).GenerateSecret()
5FWQZLQVXIBCKKMJ
DEMO&gt;write ##class(User.View.Security).GenerateSecret()
M4AKQBFI252H4BWO
</pre>
<h2><span class="mw-headline" id="Go"><a href="https://rosettacode.org/wiki/Category:Go" title="Category:Go">Go</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=3" title="Edit section: Go">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>A slightly <a rel="nofollow" class="external text" href="https://github.com/gwwfps/onetime/pull/1">fixed</a> version of a <a rel="nofollow" class="external text" href="https://github.com/gwwfps/onetime">package by Zitao Zhang</a> (released under a <a rel="nofollow" class="external text" href="https://github.com/gwwfps/onetime/blob/master/LICENSE">simplified BSD license</a>).
</p>
<pre class="go highlighted_source"><span class="co1">// Package onetime provides a library for one-time password generation,</span><br><span class="co1">// implementing the HOTP and TOTP algorithms as specified by IETF RFC-4226</span><br><span class="co1">// and RFC-6238.</span><br><span class="kw1">package</span> onetime<br>&nbsp;<br><span class="kw1">import</span> <span class="sy1">(</span><br>	<span class="st0">"crypto/hmac"</span><br>	<span class="st0">"crypto/sha1"</span><br>	<span class="st0">"encoding/binary"</span><br>	<span class="st0">"errors"</span><br>	<span class="st0">"hash"</span><br>	<span class="st0">"math"</span><br>	<span class="st0">"time"</span><br><span class="sy1">)</span><br>&nbsp;<br><span class="co1">// OneTimePassword stores the configuration values relevant to HOTP/TOTP calculations.</span><br><span class="kw1">type</span> OneTimePassword <span class="kw4">struct</span> <span class="sy1">{</span><br>	Digit    <span class="kw4">int</span>              <span class="co1">// Length of code generated</span><br>	TimeStep time<span class="sy3">.</span><span class="me1">Duration</span>    <span class="co1">// Length of each time step for TOTP</span><br>	BaseTime <a href="https://golang.org/search?q=time.Time"><span class="kw5">time.<span class="me1">Time</span></span></a>        <span class="co1">// The start time for TOTP step calculation</span><br>	Hash     <span class="kw4">func</span><span class="sy1">()</span> <a href="https://golang.org/search?q=hash.Hash"><span class="kw5">hash.<span class="me1">Hash</span></span></a> <span class="co1">// Hash algorithm used with HMAC</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="co1">// HOTP returns a HOTP code with the given secret and counter.</span><br><span class="kw4">func</span> <span class="sy1">(</span>otp <span class="sy3">*</span>OneTimePassword<span class="sy1">)</span> HOTP<span class="sy1">(</span>secret <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">,</span> count <span class="kw4">uint64</span><span class="sy1">)</span> <span class="kw4">uint</span> <span class="sy1">{</span><br>	hs <span class="sy2">:=</span> otp<span class="sy3">.</span>hmacSum<span class="sy1">(</span>secret<span class="sy1">,</span> count<span class="sy1">)</span><br>	<span class="kw1">return</span> otp<span class="sy3">.</span>truncate<span class="sy1">(</span>hs<span class="sy1">)</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> <span class="sy1">(</span>otp <span class="sy3">*</span>OneTimePassword<span class="sy1">)</span> hmacSum<span class="sy1">(</span>secret <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">,</span> count <span class="kw4">uint64</span><span class="sy1">)</span> <span class="sy1">[]</span><span class="kw4">byte</span> <span class="sy1">{</span><br>	mac <span class="sy2">:=</span> hmac<span class="sy3">.</span>New<span class="sy1">(</span>otp<span class="sy3">.</span>Hash<span class="sy1">,</span> secret<span class="sy1">)</span><br>	binary<span class="sy3">.</span>Write<span class="sy1">(</span>mac<span class="sy1">,</span> binary<span class="sy3">.</span>BigEndian<span class="sy1">,</span> count<span class="sy1">)</span><br>	<span class="kw1">return</span> mac<span class="sy3">.</span>Sum<span class="sy1">(</span><span class="kw2">nil</span><span class="sy1">)</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> <span class="sy1">(</span>otp <span class="sy3">*</span>OneTimePassword<span class="sy1">)</span> truncate<span class="sy1">(</span>hs <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">)</span> <span class="kw4">uint</span> <span class="sy1">{</span><br>	sbits <span class="sy2">:=</span> dt<span class="sy1">(</span>hs<span class="sy1">)</span><br>	snum <span class="sy2">:=</span> <span class="kw4">uint</span><span class="sy1">(</span>sbits<span class="sy1">[</span><span class="nu0">3</span><span class="sy1">])</span> <span class="sy3">|</span> <span class="kw4">uint</span><span class="sy1">(</span>sbits<span class="sy1">[</span><span class="nu0">2</span><span class="sy1">])</span>&lt;&lt;<span class="nu0">8</span><br>	snum <span class="sy2">|=</span> <span class="kw4">uint</span><span class="sy1">(</span>sbits<span class="sy1">[</span><span class="nu0">1</span><span class="sy1">])</span>&lt;&lt;<span class="nu0">16</span> <span class="sy3">|</span> <span class="kw4">uint</span><span class="sy1">(</span>sbits<span class="sy1">[</span><span class="nu0">0</span><span class="sy1">])</span>&lt;&lt;<span class="nu0">24</span><br>	<span class="kw1">return</span> snum <span class="sy3">%</span> <span class="kw4">uint</span><span class="sy1">(</span>math<span class="sy3">.</span>Pow<span class="sy1">(</span><span class="nu0">10</span><span class="sy1">,</span> <span class="kw4">float64</span><span class="sy1">(</span>otp<span class="sy3">.</span>Digit<span class="sy1">)))</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="co1">// Simple returns a new OneTimePassword with the specified HTOP code length,</span><br><span class="co1">// SHA-1 as the HMAC hash algorithm, the Unix epoch as the base time, and</span><br><span class="co1">// 30 seconds as the step length.</span><br><span class="kw4">func</span> Simple<span class="sy1">(</span>digit <span class="kw4">int</span><span class="sy1">)</span> <span class="sy1">(</span>otp OneTimePassword<span class="sy1">,</span> err error<span class="sy1">)</span> <span class="sy1">{</span><br>	<span class="kw1">if</span> digit &lt; <span class="nu0">6</span> <span class="sy1">{</span><br>		err <span class="sy2">=</span> errors<span class="sy3">.</span>New<span class="sy1">(</span><span class="st0">"minimum of 6 digits is required for a valid HTOP code"</span><span class="sy1">)</span><br>		<span class="kw1">return</span><br>	<span class="sy1">}</span> <span class="kw1">else</span> <span class="kw1">if</span> digit &gt; <span class="nu0">9</span> <span class="sy1">{</span><br>		err <span class="sy2">=</span> errors<span class="sy3">.</span>New<span class="sy1">(</span><span class="st0">"HTOP code cannot be longer than 9 digits"</span><span class="sy1">)</span><br>		<span class="kw1">return</span><br>	<span class="sy1">}</span><br>	<span class="kw1">const</span> step <span class="sy2">=</span> <span class="nu0">30</span> <span class="sy3">*</span> time<span class="sy3">.</span>Second<br>	otp <span class="sy2">=</span> OneTimePassword<span class="sy1">{</span>digit<span class="sy1">,</span> step<span class="sy1">,</span> time<span class="sy3">.</span>Unix<span class="sy1">(</span><span class="nu0">0</span><span class="sy1">,</span> <span class="nu0">0</span><span class="sy1">),</span> sha1<span class="sy3">.</span>New<span class="sy1">}</span><br>	<span class="kw1">return</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="co1">// TOTP returns a TOTP code calculated with the current time and the given secret.</span><br><span class="kw4">func</span> <span class="sy1">(</span>otp <span class="sy3">*</span>OneTimePassword<span class="sy1">)</span> TOTP<span class="sy1">(</span>secret <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">)</span> <span class="kw4">uint</span> <span class="sy1">{</span><br>	<span class="kw1">return</span> otp<span class="sy3">.</span>HOTP<span class="sy1">(</span>secret<span class="sy1">,</span> otp<span class="sy3">.</span>steps<span class="sy1">(</span>time<span class="sy3">.</span>Now<span class="sy1">()))</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> <span class="sy1">(</span>otp <span class="sy3">*</span>OneTimePassword<span class="sy1">)</span> steps<span class="sy1">(</span>now <a href="https://golang.org/search?q=time.Time"><span class="kw5">time.<span class="me1">Time</span></span></a><span class="sy1">)</span> <span class="kw4">uint64</span> <span class="sy1">{</span><br>	elapsed <span class="sy2">:=</span> now<span class="sy3">.</span>Unix<span class="sy1">()</span> <span class="sy3">-</span> otp<span class="sy3">.</span>BaseTime<span class="sy3">.</span>Unix<span class="sy1">()</span><br>	<span class="kw1">return</span> <span class="kw4">uint64</span><span class="sy1">(</span><span class="kw4">float64</span><span class="sy1">(</span>elapsed<span class="sy1">)</span> <span class="sy3">/</span> otp<span class="sy3">.</span>TimeStep<span class="sy3">.</span>Seconds<span class="sy1">())</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> dt<span class="sy1">(</span>hs <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">)</span> <span class="sy1">[]</span><span class="kw4">byte</span> <span class="sy1">{</span><br>	offset <span class="sy2">:=</span> <span class="kw4">int</span><span class="sy1">(</span>hs<span class="sy1">[</span><span class="kw3">len</span><span class="sy1">(</span>hs<span class="sy1">)</span><span class="sy3">-</span><span class="nu0">1</span><span class="sy1">]</span> &amp; <span class="nu0">0xf</span><span class="sy1">)</span><br>	p <span class="sy2">:=</span> hs<span class="sy1">[</span>offset <span class="sy1">:</span> offset<span class="sy3">+</span><span class="nu0">4</span><span class="sy1">]</span><br>	p<span class="sy1">[</span><span class="nu0">0</span><span class="sy1">]</span> &amp;<span class="sy2">=</span> <span class="nu0">0x7f</span><br>	<span class="kw1">return</span> p<br><span class="sy1">}</span></pre>
<div>
<dl><dt>Example use:</dt></dl></div>
<p>(in a format that gets put into the <a rel="nofollow" class="external text" href="https://godoc.org/github.com/dchapes/onetime">generated documentation</a>)
</p>
<pre class="go highlighted_source"><span class="kw1">package</span> onetime<br>&nbsp;<br><span class="kw1">import</span> <span class="sy1">(</span><br>	<span class="st0">"crypto/sha256"</span><br>	<span class="st0">"fmt"</span><br>	<span class="st0">"time"</span><br>&nbsp;<br>	<span class="st0">"github.com/gwwfps/onetime"</span><br><span class="sy1">)</span><br>&nbsp;<br><span class="kw4">func</span> Example_simple<span class="sy1">()</span> <span class="sy1">{</span><br>	<span class="co1">// Simple 6-digit HOTP code:</span><br>	<span class="kw1">var</span> secret <span class="sy2">=</span> <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">(</span><span class="st0">"SOME_SECRET"</span><span class="sy1">)</span><br>	<span class="kw1">var</span> counter <span class="kw4">uint64</span> <span class="sy2">=</span> <span class="nu0">123456</span><br>	<span class="kw1">var</span> otp<span class="sy1">,</span> _ <span class="sy2">=</span> onetime<span class="sy3">.</span>Simple<span class="sy1">(</span><span class="nu0">6</span><span class="sy1">)</span><br>	<span class="kw1">var</span> code <span class="sy2">=</span> otp<span class="sy3">.</span>HOTP<span class="sy1">(</span>secret<span class="sy1">,</span> counter<span class="sy1">)</span><br>	fmt<span class="sy3">.</span>Println<span class="sy1">(</span>code<span class="sy1">)</span><br>	<span class="co1">// Output:</span><br>	<span class="co1">// 260040</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> Example_authenticator<span class="sy1">()</span> <span class="sy1">{</span><br>	<span class="co1">// Google authenticator style 8-digit TOTP code:</span><br>	<span class="kw1">var</span> secret <span class="sy2">=</span> <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">(</span><span class="st0">"SOME_SECRET"</span><span class="sy1">)</span><br>	<span class="kw1">var</span> otp<span class="sy1">,</span> _ <span class="sy2">=</span> onetime<span class="sy3">.</span>Simple<span class="sy1">(</span><span class="nu0">8</span><span class="sy1">)</span><br>	<span class="kw1">var</span> code <span class="sy2">=</span> otp<span class="sy3">.</span>TOTP<span class="sy1">(</span>secret<span class="sy1">)</span><br>	fmt<span class="sy3">.</span>Println<span class="sy1">(</span>code<span class="sy1">)</span><br><span class="sy1">}</span><br>&nbsp;<br><span class="kw4">func</span> Example_custom<span class="sy1">()</span> <span class="sy1">{</span><br>	<span class="co1">// 9-digit 5-second-step TOTP starting on midnight 2000-01-01 UTC, using SHA-256:</span><br>	<span class="kw1">var</span> secret <span class="sy2">=</span> <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">(</span><span class="st0">"SOME_SECRET"</span><span class="sy1">)</span><br>	<span class="kw1">const</span> ts <span class="sy2">=</span> <span class="nu0">5</span> <span class="sy3">*</span> time<span class="sy3">.</span>Second<br>	<span class="kw1">var</span> t <span class="sy2">=</span> time<span class="sy3">.</span>Date<span class="sy1">(</span><span class="nu0">2000</span><span class="sy1">,</span> time<span class="sy3">.</span>January<span class="sy1">,</span> <span class="nu0">1</span><span class="sy1">,</span> <span class="nu0">0</span><span class="sy1">,</span> <span class="nu0">0</span><span class="sy1">,</span> <span class="nu0">0</span><span class="sy1">,</span> <span class="nu0">0</span><span class="sy1">,</span> time<span class="sy3">.</span>UTC<span class="sy1">)</span><br>	<span class="kw1">var</span> otp <span class="sy2">=</span> onetime<span class="sy3">.</span>OneTimePassword<span class="sy1">{</span><br>		Digit<span class="sy1">:</span> <span class="nu0">9</span><span class="sy1">,</span> TimeStep<span class="sy1">:</span> ts<span class="sy1">,</span> BaseTime<span class="sy1">:</span> t<span class="sy1">,</span> Hash<span class="sy1">:</span> sha256<span class="sy3">.</span>New<span class="sy1">}</span><br>	<span class="kw1">var</span> code <span class="sy2">=</span> otp<span class="sy3">.</span>TOTP<span class="sy1">(</span>secret<span class="sy1">)</span><br>	fmt<span class="sy3">.</span>Println<span class="sy1">(</span>code<span class="sy1">)</span><br><span class="sy1">}</span></pre>
<h2><span class="mw-headline" id="Julia"><a href="https://rosettacode.org/wiki/Category:Julia" title="Category:Julia">Julia</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=4" title="Edit section: Julia">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="text highlighted_source">using CodecBase<br>using SHA<br>&nbsp;<br>function hmac(key, msg, hashfunction, blocksize=64)<br>    key = hashfunction(key)<br>    paddingneeded = blocksize - length(key)<br>    if paddingneeded &gt; 0<br>        resize!(key, blocksize)<br>        key[end-paddingneeded+1:end] .= 0<br>    end<br>    return hashfunction([key .‚äª 0x5c; hashfunction([key .‚äª 0x36; msg])])<br>end<br>&nbsp;<br>#see also https://github.com/ylxdzsw/TOTP.jl<br>hmac(hashfunc, bs=64) = (key, msg, blocksize=bs) -&gt; hmac(key, msg, hashfunc, blocksize)<br>&nbsp;<br>function genotp(secret::String; tokenlength=6, hashfunc=hmac(sha1), tim=time()/30, outbase=10)<br>    message = (([UInt8((Int(floor(tim)) &gt;&gt; 8i) &amp; 0xff) for i in 7:-1:0]))<br>    msghash = hashfunc(secret, message)<br>&nbsp;<br>    offset = msghash[length(msghash)] &amp; 0x0f<br>    binary = (Int(msghash[offset+1] &amp; 0x7f) &lt;&lt; 24) |<br>             (Int(msghash[offset+2] &amp; 0xff) &lt;&lt; 16) | <br>             (Int(msghash[offset+3] &amp; 0xff) &lt;&lt; 8) |<br>             (msghash[offset+4] &amp; 0xff)<br>    otp = binary&nbsp;% outbase^tokenlength<br>    string(otp, pad=tokenlength, base=outbase)<br>end<br>&nbsp;<br>function genopt_fromb32(secret32; kwargs...)<br>    secret = transcode(Base32Decoder(), secret32)<br>    return genotp(secret; kwargs...)<br>end<br>&nbsp;<br>for i in 1:7<br>    println(genotp("JBSWY3DPEHPK3PXP"))<br>    sleep(15)<br>end<br>&nbsp;</pre><div>
<dl><dt>Output:</dt></dl></div>
<pre>656601
537396
537396
656756
656756
514592
514592
</pre>
<h2><span class="mw-headline" id="Nim"><a href="https://rosettacode.org/wiki/Category:Nim" title="Category:Nim">Nim</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=5" title="Edit section: Nim">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta translation"><b>Translation of</b>: <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Go">Go</a></div>
<p>We borrowed the HMAC function from Julia solution, but didn‚Äôt apply a hash on the key at beginning. This way, we obtain the same result as Go for the ‚ÄúSimple‚Äù example.
</p><p>Note that due to the interface of the hash function in module ‚Äústd/sha1‚Äù, we have chosen to work with sequences of characters rather than sequences of bytes. The other way is of course possible, but maybe less convenient.
</p>
<pre class="text highlighted_source">import endians, math, sequtils, std/sha1, times<br>&nbsp;<br>type<br>&nbsp;<br>  HashFunc = proc(msg: openArray[char]): seq[char]<br>&nbsp;<br>  OneTimePassword = object<br>    digit: int          # Length of code generated.<br>    timeStep: Duration  # Length of each time step for TOTP.<br>    baseTime: Time      # The start time for TOTP step calculation.<br>    hash: HashFunc      # Hash algorithm used with HMAC.<br>&nbsp;<br>&nbsp;<br>func sha1Hash(msg: openArray[char]): seq[char] =<br>  mapIt(@(Sha1Digest(secureHash(msg))), char(it))<br>&nbsp;<br>&nbsp;<br>func `xor`(s: seq[char]; val: byte): seq[char] =<br>  ## Apply a XOR to the chars of a sequence.<br>  s.mapIt(char(it.byte xor val))<br>&nbsp;<br>&nbsp;<br>func hmac(key, msg: openArray[char]; hashFunc: HashFunc; blockSize = 64): seq[char] =<br>  ## Compute a HMAC for gien key, message, hash function and block size.<br>  var key = @key<br>  let paddingNeeded = blockSize - key.len<br>  if paddingNeeded &gt; 0: key.setLen(blockSize)<br>  result = hashFunc((key xor 0x5c) &amp; hashFunc((key xor 0x36) &amp; @msg))<br>&nbsp;<br>&nbsp;<br>func simple(digit: int): OneTimePassword =<br>  ## Return a new OneTimePassword with the specified HTOP code length,<br>  ## SHA-1 as the HMAC hash algorithm, the Unix epoch as the base time, and<br>  ## 30 seconds as the step length.<br>  doAssert digit in 6..9, "HTOP code length must be in 6..9."<br>  let step = initDuration(seconds = 30)<br>  result = OneTimePassword(digit: digit, timeStep: step, baseTime: fromUnix(0), hash: sha1Hash)<br>&nbsp;<br>&nbsp;<br>func hmacSum(otp: OneTimePassword; secret: openArray[char]; count: uint64): seq[char] =<br>  var count = count<br>  var beCount: uint64<br>  bigEndian64(beCount.addr, count.addr)<br>  let msg = cast[array[8, char]](beCount)<br>  result = hmac(secret, msg, otp.hash)<br>&nbsp;<br>&nbsp;<br>func dt(hs: seq[char]): seq[char] =<br>  let offset = hs[^1].byte and 0xf<br>  result = hs[offset..offset+3]<br>  result[0] = char(result[0].byte and 0x7f)<br>&nbsp;<br>&nbsp;<br>func truncate(otp: OneTimePassword; hs: seq[char]): uint64 =<br>  let sbits = dt(hs)<br>  let snum = sbits[3].uint64 or sbits[2].uint64 shl 8 or<br>             sbits[1].uint64 shl 16 or sbits[0].uint64 shl 24<br>  result = snum mod 10u^otp.digit<br>&nbsp;<br>&nbsp;<br>func hotp(otp: OneTimePassword; secret: openArray[char]; count: uint64): uint64 =<br>  let hs = otp.hmacSum(secret, count)<br>  result = otp.truncate(hs)<br>&nbsp;<br>&nbsp;<br>func steps(otp: OneTimePassword; t: Time): uint64 =<br>  let elapsed = t - otp.baseTime<br>  result = uint64(elapsed.inSeconds div otp.timeStep.inSeconds)<br>&nbsp;<br>&nbsp;<br>proc totp(otp: OneTimePassword; secret: openArray[char]): uint64 =<br>  ## Return a TOTP code calculated with the current time and the given secret.<br>  otp.hotp(secret, otp.steps(getTime()))<br>&nbsp;<br>&nbsp;<br>when isMainModule:<br>&nbsp;<br>  proc exampleSimple =<br>    ## Simple 6-digit HOTP code.<br>    const secret = "SOME_SECRET"<br>    var counter: uint64 = 123456<br>    let otp = simple(6)<br>    let code = otp.hotp(secret, counter)<br>    echo code<br>    # Output:<br>    # 260040<br>&nbsp;<br>  proc exampleAuthenticator =<br>    ## Google authenticator style 8-digit TOTP code.<br>    const secret = "SOME_SECRET"<br>    let otp = simple(8)<br>    let code = otp.totp(secret)<br>    echo code<br>&nbsp;<br>  echo "Simple:"<br>  exampleSimple()<br>&nbsp;<br>  echo "Google authenticator:"<br>  exampleAuthenticator()</pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>Simple:
260040
Google authenticator:
94364703</pre>
<h2><span class="mw-headline" id="Perl"><a href="https://rosettacode.org/wiki/Category:Perl" title="Category:Perl">Perl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=6" title="Edit section: Perl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta translation"><b>Translation of</b>: <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Raku">Raku</a></div>
<pre class="perl highlighted_source"><span class="co1"># 20200704 added Perl programming solution</span><br>&nbsp;<br><span class="kw2">use</span> strict<span class="sy0">;</span><br><span class="kw2">use</span> warnings<span class="sy0">;</span><br>&nbsp;<br><span class="kw2">use</span> Authen<span class="sy0">::</span><span class="me2">OATH</span><span class="sy0">;</span><br>&nbsp;<br><span class="kw1">my</span> <span class="re0">$message</span> <span class="sy0">=</span> <span class="st0">"show me the monKey"</span><span class="sy0">;</span> <span class="co1"># convert to base32 is optional</span><br>&nbsp;<br><span class="kw1">my</span> <span class="re0">$oath</span> <span class="sy0">=</span> Authen<span class="sy0">::</span><span class="me2">OATH</span><span class="sy0">-&gt;</span><span class="kw2">new</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1"># default SHA1 and TI=30</span><br>&nbsp;<br><span class="kw1">for</span> <span class="br0">(</span> <span class="kw1">my</span> <span class="re0">$t</span> <span class="sy0">=</span> <span class="nu0">2177452800</span> <span class="sy0">;</span> <span class="re0">$t</span> <span class="sy0">&lt;</span> <span class="nu0">2177452919</span> <span class="sy0">;</span> <span class="re0">$t</span> <span class="sy0">+=</span> <span class="nu0">13</span> <span class="br0">)</span> <span class="br0">{</span><br>   <a href="https://perldoc.perl.org/functions/print.html"><span class="kw3">print</span></a> <span class="st0">"At "</span><span class="sy0">,</span> <a href="https://perldoc.perl.org/functions/scalar.html"><span class="kw3">scalar</span></a> <a href="https://perldoc.perl.org/functions/gmtime.html"><span class="kw3">gmtime</span></a> <span class="re0">$t</span><span class="sy0">,</span> <span class="st0">"&nbsp;: "</span><span class="sy0">,</span> <span class="re0">$oath</span><span class="sy0">-&gt;</span><span class="me1">totp</span><span class="br0">(</span> <span class="re0">$message</span><span class="sy0">,</span> <span class="re0">$t</span> <span class="br0">)</span><span class="sy0">,</span> <span class="st0">"<span class="es0">\n</span>"</span> <span class="sy0">;</span><br><span class="br0">}</span></pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>At Sat Jan  1 00:00:00 2039&nbsp;: 950428
At Sat Jan  1 00:00:13 2039&nbsp;: 950428
At Sat Jan  1 00:00:26 2039&nbsp;: 950428
At Sat Jan  1 00:00:39 2039&nbsp;: 361382
At Sat Jan  1 00:00:52 2039&nbsp;: 361382
At Sat Jan  1 00:01:05 2039&nbsp;: 022576
At Sat Jan  1 00:01:18 2039&nbsp;: 022576
At Sat Jan  1 00:01:31 2039&nbsp;: 341623
At Sat Jan  1 00:01:44 2039&nbsp;: 341623
At Sat Jan  1 00:01:57 2039&nbsp;: 341623
</pre>
<h2><span class="mw-headline" id="Phix"><a href="https://rosettacode.org/wiki/Category:Phix" title="Category:Phix">Phix</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=7" title="Edit section: Phix">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta translation"><b>Translation of</b>: <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Perl">Perl</a></div>
<p>Note the byte ordering of hmac (etc) is suspect and may change, hence bmap below
</p>
<pre><span style="color: #7060A8;">requires</span><span style="color: #0000FF;">(</span><span style="color: #008000;">"1.0.1"</span><span style="color: #0000FF;">)</span>   <span style="color: #000080;font-style:italic;">-- sha1.e added</span>
<span style="color: #008080;">include</span> <span style="color: #000000;">sha1</span><span style="color: #0000FF;">.</span><span style="color: #000000;">e</span>
<span style="color: #008080;">include</span> <span style="color: #000000;">hmac</span><span style="color: #0000FF;">.</span><span style="color: #000000;">e</span>

<span style="color: #008080;">constant</span> <span style="color: #000000;">bmap</span> <span style="color: #0000FF;">=</span> <span style="color: #0000FF;">{</span><span style="color: #000000;">4</span><span style="color: #0000FF;">,</span><span style="color: #000000;">3</span><span style="color: #0000FF;">,</span><span style="color: #000000;">2</span><span style="color: #0000FF;">,</span><span style="color: #000000;">1</span><span style="color: #0000FF;">,</span><span style="color: #000000;">8</span><span style="color: #0000FF;">,</span><span style="color: #000000;">7</span><span style="color: #0000FF;">,</span><span style="color: #000000;">6</span><span style="color: #0000FF;">,</span><span style="color: #000000;">5</span><span style="color: #0000FF;">,</span><span style="color: #000000;">12</span><span style="color: #0000FF;">,</span><span style="color: #000000;">11</span><span style="color: #0000FF;">,</span><span style="color: #000000;">10</span><span style="color: #0000FF;">,</span><span style="color: #000000;">9</span><span style="color: #0000FF;">,</span><span style="color: #000000;">16</span><span style="color: #0000FF;">,</span><span style="color: #000000;">15</span><span style="color: #0000FF;">,</span><span style="color: #000000;">14</span><span style="color: #0000FF;">,</span><span style="color: #000000;">13</span><span style="color: #0000FF;">,</span><span style="color: #000000;">20</span><span style="color: #0000FF;">,</span><span style="color: #000000;">19</span><span style="color: #0000FF;">,</span><span style="color: #000000;">18</span><span style="color: #0000FF;">,</span><span style="color: #000000;">17</span><span style="color: #0000FF;">}</span>
<span style="color: #008080;">function</span> <span style="color: #000000;">dt</span><span style="color: #0000FF;">(</span><span style="color: #004080;">string</span> <span style="color: #000000;">hmac_result</span><span style="color: #0000FF;">,</span> <span style="color: #004080;">integer</span> <span style="color: #000000;">digits</span><span style="color: #0000FF;">=</span><span style="color: #000000;">6</span><span style="color: #0000FF;">)</span>
    <span style="color: #004080;">atom</span> <span style="color: #000000;">a</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">0</span>
    <span style="color: #004080;">integer</span> <span style="color: #000000;">offset</span> <span style="color: #0000FF;">=</span> <span style="color: #7060A8;">and_bits</span><span style="color: #0000FF;">(</span><span style="color: #000000;">hmac_result</span><span style="color: #0000FF;">[</span><span style="color: #000000;">bmap</span><span style="color: #0000FF;">[$]],</span><span style="color: #000000;">#0F</span><span style="color: #0000FF;">)</span>
    <span style="color: #008080;">for</span> <span style="color: #000000;">i</span><span style="color: #0000FF;">=</span><span style="color: #000000;">1</span> <span style="color: #008080;">to</span> <span style="color: #000000;">4</span> <span style="color: #008080;">do</span>
        <span style="color: #000000;">a</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">a</span><span style="color: #0000FF;">*</span><span style="color: #000000;">#100</span><span style="color: #0000FF;">+</span><span style="color: #000000;">hmac_result</span><span style="color: #0000FF;">[</span><span style="color: #000000;">bmap</span><span style="color: #0000FF;">[</span><span style="color: #000000;">offset</span><span style="color: #0000FF;">+</span><span style="color: #000000;">i</span><span style="color: #0000FF;">]]</span>
        <span style="color: #008080;">if</span> <span style="color: #000000;">i</span><span style="color: #0000FF;">=</span><span style="color: #000000;">1</span> <span style="color: #008080;">then</span> <span style="color: #000000;">a</span> <span style="color: #0000FF;">=</span> <span style="color: #7060A8;">and_bits</span><span style="color: #0000FF;">(</span><span style="color: #000000;">a</span><span style="color: #0000FF;">,</span><span style="color: #000000;">#7F</span><span style="color: #0000FF;">)</span> <span style="color: #008080;">end</span> <span style="color: #008080;">if</span>
    <span style="color: #008080;">end</span> <span style="color: #008080;">for</span>
    <span style="color: #000000;">a</span> <span style="color: #0000FF;">=</span> <span style="color: #7060A8;">remainder</span><span style="color: #0000FF;">(</span><span style="color: #000000;">a</span><span style="color: #0000FF;">,</span><span style="color: #7060A8;">power</span><span style="color: #0000FF;">(</span><span style="color: #000000;">10</span><span style="color: #0000FF;">,</span><span style="color: #000000;">digits</span><span style="color: #0000FF;">))</span>
    <span style="color: #008080;">return</span> <span style="color: #000000;">a</span>
<span style="color: #008080;">end</span> <span style="color: #008080;">function</span>

<span style="color: #008080;">function</span> <span style="color: #000000;">totp</span><span style="color: #0000FF;">(</span><span style="color: #004080;">string</span> <span style="color: #000000;">msg</span><span style="color: #0000FF;">,</span> <span style="color: #004080;">atom</span> <span style="color: #000000;">t</span><span style="color: #0000FF;">)</span>
    <span style="color: #004080;">string</span> <span style="color: #000000;">ts</span> <span style="color: #0000FF;">=</span> <span style="color: #7060A8;">int_to_bytes</span><span style="color: #0000FF;">(</span><span style="color: #7060A8;">floor</span><span style="color: #0000FF;">(</span><span style="color: #000000;">t</span><span style="color: #0000FF;">/</span><span style="color: #000000;">30</span><span style="color: #0000FF;">),</span><span style="color: #000000;">8</span><span style="color: #0000FF;">),</span>
            <span style="color: #000000;">d</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">hmac_sha1</span><span style="color: #0000FF;">(</span><span style="color: #000000;">msg</span><span style="color: #0000FF;">,</span><span style="color: #7060A8;">reverse</span><span style="color: #0000FF;">(</span><span style="color: #000000;">ts</span><span style="color: #0000FF;">))</span>
    <span style="color: #008080;">return</span> <span style="color: #000000;">dt</span><span style="color: #0000FF;">(</span><span style="color: #000000;">d</span><span style="color: #0000FF;">)</span>
<span style="color: #008080;">end</span> <span style="color: #008080;">function</span>

<span style="color: #008080;">include</span> <span style="color: #000000;">timedate</span><span style="color: #0000FF;">.</span><span style="color: #000000;">e</span>
<span style="color: #000000;">set_timedate_formats</span><span style="color: #0000FF;">({</span><span style="color: #008000;">"Mmm dth yyyy h:mm:ss"</span><span style="color: #0000FF;">})</span>
<span style="color: #000000;">timedate</span> <span style="color: #000000;">td0</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">parse_date_string</span><span style="color: #0000FF;">(</span><span style="color: #008000;">"Jan 1st 1970 00:00:00"</span><span style="color: #0000FF;">)</span>

<span style="color: #008080;">constant</span> <span style="color: #000000;">message</span> <span style="color: #0000FF;">=</span> <span style="color: #008000;">"show me the monKey"</span>
<span style="color: #008080;">for</span> <span style="color: #000000;">i</span><span style="color: #0000FF;">=</span><span style="color: #000000;">0</span> <span style="color: #008080;">to</span> <span style="color: #000000;">9</span> <span style="color: #008080;">do</span>
    <span style="color: #004080;">atom</span> <span style="color: #000000;">t</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">2177452800</span><span style="color: #0000FF;">+</span><span style="color: #000000;">i</span><span style="color: #0000FF;">*</span><span style="color: #000000;">13</span>
    <span style="color: #004080;">string</span> <span style="color: #000000;">d</span> <span style="color: #0000FF;">=</span> <span style="color: #000000;">format_timedate</span><span style="color: #0000FF;">(</span><span style="color: #000000;">adjust_timedate</span><span style="color: #0000FF;">(</span><span style="color: #000000;">td0</span><span style="color: #0000FF;">,</span><span style="color: #000000;">t</span><span style="color: #0000FF;">))</span>
    <span style="color: #7060A8;">printf</span><span style="color: #0000FF;">(</span><span style="color: #000000;">1</span><span style="color: #0000FF;">,</span><span style="color: #008000;">"At&nbsp;%s&nbsp;:&nbsp;%06d\n"</span><span style="color: #0000FF;">,{</span><span style="color: #000000;">d</span><span style="color: #0000FF;">,</span><span style="color: #000000;">totp</span><span style="color: #0000FF;">(</span><span style="color: #000000;">message</span><span style="color: #0000FF;">,</span><span style="color: #000000;">t</span><span style="color: #0000FF;">)})</span>
<span style="color: #008080;">end</span> <span style="color: #008080;">for</span>
</pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>At Jan 1st 2039 0:00:00&nbsp;: 950428
At Jan 1st 2039 0:00:13&nbsp;: 950428
At Jan 1st 2039 0:00:26&nbsp;: 950428
At Jan 1st 2039 0:00:39&nbsp;: 361382
At Jan 1st 2039 0:00:52&nbsp;: 361382
At Jan 1st 2039 0:01:05&nbsp;: 022576
At Jan 1st 2039 0:01:18&nbsp;: 022576
At Jan 1st 2039 0:01:31&nbsp;: 341623
At Jan 1st 2039 0:01:44&nbsp;: 341623
At Jan 1st 2039 0:01:57&nbsp;: 341623
</pre>
<h2><span class="mw-headline" id="PicoLisp"><a href="https://rosettacode.org/wiki/Category:PicoLisp" title="Category:PicoLisp">PicoLisp</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=8" title="Edit section: PicoLisp">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Using the <tt>sha1</tt> function defined at <i><a href="https://rosettacode.org/wiki/SHA-1#PicoLisp" title="SHA-1">SHA-1#PicoLisp</a></i>:
</p>
<pre class="text highlighted_source">(load "sha1.l")<br>&nbsp;<br>(de hmac ("Fun" Msg Key)<br>   (let (Key (copy Key)  Len (length Key))<br>      (and<br>         (&gt; Len 64)<br>         (setq Key ("Fun" Key)) )<br>      (setq Key (need -64 Key 0))<br>      ("Fun"<br>         (append<br>            (mapcar x| (need 64 `(hex "5C")) Key)<br>            ("Fun" (append (mapcar x| (need 64 `(hex "36")) Key) Msg)) ) ) ) )<br>&nbsp;<br>(de endian64 (N)<br>   (make<br>      (do 8<br>         (yoke (&amp; N 255))<br>         (setq N (&gt;&gt; 8 N)) ) ) )<br>&nbsp;<br>(de endian32 (L)<br>   (apply<br>      |<br>      (mapcar &gt;&gt; (-24 -16 -8 0) L) ) )<br>&nbsp;<br>(de truncate (Lst D)<br>   (let L (nth Lst (inc (&amp; (last Lst) `(hex "F"))))<br>      (set L (&amp; (car L) `(hex "7F")))<br>      (% (endian32 (head 4 L)) (** 10 D)) ) )<br>&nbsp;<br>(de hotp (K N D)<br>   (default D 6)<br>   (truncate<br>      (hmac 'sha1 (endian64 N) K)<br>      D ) )<br>&nbsp;<br>(def 'totp hotp)<br>&nbsp;<br># RFC4226<br>(for<br>   (I . N)<br>   (755224 287082 359152 969429 338314<br>      254676 287922 162583 399871 520489 )<br>   (test<br>      N<br>      (hotp (mapcar char (chop "12345678901234567890")) (dec I)) ) )<br>&nbsp;<br># RFC6238<br>(for L<br>   (quote<br>      (1 . 94287082) (37037036 . 7081804) (37037037 . 14050471)<br>      (41152263 . 89005924) (66666666 . 69279037) (666666666 . 65353130) )<br>   (test<br>      (cdr L)<br>      (totp (mapcar char (chop "12345678901234567890")) (car L) 8) ) )</pre>
<h2><span class="mw-headline" id="Racket"><a href="https://rosettacode.org/wiki/Category:Racket" title="Category:Racket">Racket</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=9" title="Edit section: Racket">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This includes BASE32 encoding, token based authentication and other such stuff.
</p>
<pre class="text highlighted_source">#lang racket<br>(require (only-in web-server/stuffers/hmac-sha1 HMAC-SHA1))<br>&nbsp;<br>(define &lt;&lt; arithmetic-shift)&nbsp;; deep down, there lurks a C programmer in me<br>(define &amp;&amp; bitwise-and)<br>&nbsp;<br>;; These are the parameters available through RFC6238<br>(define T0 (make-parameter current-seconds))&nbsp;; produces unix epoch times. parameterised for testing<br>(define X  (make-parameter 30))<br>(define H  (make-parameter (lambda (k d) (HMAC-SHA1 k d))))<br>(define N  (make-parameter 6))<br>&nbsp;<br>;; http://tools.ietf.org/html/rfc4226#section-5.3<br>(define (HOTP sha1-bytes (Digit (N)))<br>  (define (DT b)<br>    (define offset (&amp;&amp; #b1111 (bytes-ref b 19)))<br>    (define P/32 (subbytes b offset (+ offset 4)))<br>    (+ (&lt;&lt; (bytes-ref P/32 3) 0) (&lt;&lt; (bytes-ref P/32 2) 8) (&lt;&lt; (bytes-ref P/32 1) 16)<br>       (&lt;&lt; (&amp;&amp; #b01111111 (bytes-ref P/32 0)) 24)))  <br>  (define s-bits (DT sha1-bytes))<br>  (modulo s-bits (expt 10 Digit)))<br>&nbsp;<br>(define (Generate-HOTP K C (Digit (N)))<br>  (HOTP ((H) K (integer-&gt;integer-bytes C 8 #t)) Digit))<br>&nbsp;<br>;; http://tools.ietf.org/html/rfc6238<br>(define (T #:previous-timeframe (T- 0))<br>  (- (quotient ((T0)) (X)) T-))<br>&nbsp;<br>(define (TOTP K #:previous-timeframe (T- 0)) (Generate-HOTP K (T #:previous-timeframe T-) (N)))<br>&nbsp;<br>;; RFC 3548<br>(define (pad-needed bits)<br>  (modulo (- 5 bits) 5))<br>&nbsp;<br>(define (5-bits-&gt;base32-char n)<br>  (string-ref "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567" n))<br>&nbsp;<br>(define (base32-encode-block bs)<br>  (define v (for/fold ((v 0)) ((b bs)) (+ (&lt;&lt; v 8) b)))<br>  (define v-bits (* 8 (bytes-length bs)))<br>  (define pad (pad-needed v-bits))<br>  (define padded-bits (+ v-bits pad))<br>  (define v-padded (&lt;&lt; v pad))<br>  (for ((end-bit (in-range padded-bits 4 -5)))<br>    (write-char (5-bits-&gt;base32-char (bitwise-bit-field v-padded (- end-bit 5) end-bit))))<br>  (write-string (make-string (- 8 (/ padded-bits 5)) #\=)))<br>&nbsp;<br>(define A-char (char-&gt;integer #\A))<br>(define Z-char (char-&gt;integer #\Z))<br>(define 2-char (char-&gt;integer #\2))<br>(define 7-char (char-&gt;integer #\7))<br>(define =-char (char-&gt;integer #\=))<br>(define (byte-&gt;5bit b)<br>  (cond<br>    [(&lt;= A-char b Z-char) (- b A-char)]<br>    [(&lt;= 2-char b 7-char) (+ 26 (- b 2-char))]<br>    [else #f]))<br>&nbsp;<br>(define (base32-decode-block bs)<br>  (for*/fold ((v 0) (b 0)) ((bt bs) (b5 (in-value (byte-&gt;5bit bt))) #:break (not b5))<br>    (define v+ (+ (&lt;&lt; v 5) b5))<br>    (define b+ (+ b 5))<br>    (cond<br>      [(&lt; b+ 8) (values v+ b+)]<br>      [else<br>       (define start-bit (- b+ 8))<br>       (write-byte (&amp;&amp; 255 (&lt;&lt; v+ (- start-bit))))<br>       (values (bitwise-bit-field v+ 0 start-bit) start-bit)])))<br>&nbsp;<br>(define (base32-encode) (for ((bs (in-port (curry read-bytes 5)))) (base32-encode-block bs)))<br>(define (base32-decode) (for ((bs (in-port (curry read-bytes 8)))) (base32-decode-block bs)))<br>&nbsp;<br>(define (base32-encode-bytes b) (with-input-from-bytes b (Œª () (with-output-to-bytes base32-encode))))<br>(define (base32-decode-bytes b) (with-input-from-bytes b (Œª () (with-output-to-bytes base32-decode))))<br>&nbsp;<br>(module+ main<br>  (require racket/date)<br> &nbsp;;; my secret, as stuck on a postit note on my monitor<br>  (define Tims-K #"Super Secret Password Key 88!")<br>&nbsp;<br>  (define ((pseudo-time-now (offset 0))) (+ 1413976828 offset))<br>  (define totp #f)<br>  (parameterize ((T0 (pseudo-time-now)))<br>    (printf "I want authentication at: ~a ~s~%" ((T0)) (date-&gt;string (seconds-&gt;date ((T0))) #t))<br>    (set! totp (TOTP (base32-encode-bytes Tims-K)))<br>    (printf "My TOTP is: ~a~%" totp)<br>    (printf "sent to authentication service...~%"))<br>&nbsp;<br> &nbsp;;; as stored on authenticator<br>  (define K/base32 (base32-encode-bytes Tims-K))<br>  (printf "K/base32: ~a~%" K/base32)<br>&nbsp;<br>  (parameterize ((T0 (pseudo-time-now 1)))<br>    (printf "1 second later... authentication service checks against: ~a~%" totp)<br>    (define auth-totp (TOTP K/base32))<br>    (printf "~a is the same? ~a~%" auth-totp (= totp auth-totp)))<br>&nbsp;<br>  (parameterize ((T0 (pseudo-time-now 3)))<br>    (printf "but 3 seconds later... authentication service checks against: ~a~%" totp)<br>    (define auth-totp (TOTP K/base32))<br>    (printf "~a is the same? ~a~%" auth-totp (= totp auth-totp))<br>    (printf "oh dear... fall back one time-frame...~%")<br>    (define auth-totp-1 (TOTP K/base32 #:previous-timeframe 1))<br>    (printf "~a is *that* the same? ~a~%" auth-totp-1 (= totp auth-totp-1))))<br>&nbsp;<br>(module+ test<br>  (require tests/eli-tester)<br>  (test<br>  &nbsp;;; From RFC4226 Page 7<br>   (HOTP (bytes<br>          #x1f #x86 #x98 #x69 #x0e #x02 #xca #x16 #x61 #x85<br>          #x50 #xef #x7f #x19 #xda #x8e #x94 #x5b #x55 #x5a)<br>         6)<br>   =&gt; 872921<br>&nbsp;<br>   (pad-needed 0) =&gt; 0<br>   (pad-needed 2) =&gt; 3<br>   (pad-needed 4) =&gt; 1<br>   (pad-needed 6) =&gt; 4<br>   (pad-needed 8) =&gt; 2<br>   (pad-needed 10) =&gt; 0<br>   (pad-needed 12) =&gt; 3<br>&nbsp;<br>  &nbsp;;; http://commons.apache.org/proper/commons-codec/xref-test/org/apache/commons/codec/binary/Base32Test.html<br>   (base32-encode-bytes #"")       =&gt; #""<br>   (base32-encode-bytes #"f")      =&gt; #"MY======"<br>   (base32-encode-bytes #"fo")     =&gt; #"MZXQ===="<br>   (base32-encode-bytes #"foo")    =&gt; #"MZXW6==="<br>   (base32-encode-bytes #"foob")   =&gt; #"MZXW6YQ="<br>   (base32-encode-bytes #"fooba")  =&gt; #"MZXW6YTB"<br>   (base32-encode-bytes #"foobar") =&gt; #"MZXW6YTBOI======"<br>&nbsp;<br>   (base32-decode-bytes #"")                 =&gt; #""<br>   (base32-decode-bytes #"MY======")         =&gt; #"f"<br>   (base32-decode-bytes #"MZXQ====")         =&gt; #"fo"<br>   (base32-decode-bytes #"MZXW6===")         =&gt; #"foo"<br>   (base32-decode-bytes #"MZXW6YQ=")         =&gt; #"foob"<br>   (base32-decode-bytes #"MZXW6YTB")         =&gt; #"fooba"<br>   (base32-decode-bytes #"MZXW6YTBOI======") =&gt; #"foobar"<br>&nbsp;<br>   (base32-encode-bytes #"Super Secret Password Key 88!")<br>   =&gt; #"KN2XAZLSEBJWKY3SMV2CAUDBONZXO33SMQQEWZLZEA4DQII="<br>   ))</pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>23 tests passed
I want authentication at: 1413976828 "Wednesday, October 22nd, 2014 12:20:28pm"
My TOTP is: 742249
sent to authentication service...
K/base32: KN2XAZLSEBJWKY3SMV2CAUDBONZXO33SMQQEWZLZEA4DQII=
1 second later... authentication service checks against: 742249
742249 is the same? #t
but 3 seconds later... authentication service checks against: 742249
317129 is the same? #f
oh dear... fall back one time-frame...
742249 is *that* the same? #t</pre>
<h2><span class="mw-headline" id="Raku"><a href="https://rosettacode.org/wiki/Category:Raku" title="Category:Raku">Raku</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=10" title="Edit section: Raku">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>(formerly Perl 6)
This is a minimal attempt that covers only the "Time-based" part of the requirement.
</p>
<pre class="perl6 highlighted_source"><span class="co1"># Reference:</span><br><span class="co1"># https://github.com/retupmoca/P6-Digest-HMAC</span><br>&nbsp;<br><span class="kw2">use</span> v6<span class="sy0">.</span><span class="me1">d</span><span class="sy0">;</span><br><span class="kw2">use</span> Digest<span class="sy0">::</span><span class="me2">HMAC</span><span class="sy0">;</span><br><span class="kw2">use</span> Digest<span class="sy0">::</span><span class="me2">SHA</span><span class="sy0">;</span><br>&nbsp;<br><span class="kw2">sub</span> totp <span class="br0">(</span>Str \secret<span class="sy0">,</span> DateTime \counter<span class="sy0">,</span> Int \T0<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">,</span> Int \T1<span class="sy0">=</span><span class="nu0">30</span> <span class="sy0">--&gt;</span> Str<span class="br0">)</span> <span class="br0">{</span><br>   <span class="kw1">my</span> \key <span class="sy0">=</span> <span class="br0">(</span> counter <span class="sy0">-</span> DateTime<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span>T0<span class="br0">)</span> <span class="br0">)</span><span class="sy0">.</span><span class="me1">Int</span> <span class="kw1">div</span> T1<span class="sy0">;</span>   <br>   <span class="kw1">return</span> hmac<span class="sy0">-</span>hex<span class="br0">(</span>key<span class="sy0">.</span><span class="me1">Str</span><span class="sy0">,</span> secret<span class="sy0">,</span> <span class="re0">&amp;sha1</span><span class="br0">)</span><span class="sy0">.</span><span class="kw3">substr</span><span class="br0">(</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">6</span><span class="br0">)</span> <span class="co1"># first 6 chars of sha1</span><br><span class="br0">}</span><br>&nbsp;<br><span class="kw1">my</span> <span class="re0">$message</span> <span class="sy0">=</span> <span class="st0">"show me the monKey"</span><span class="sy0">;</span><br>&nbsp;<br><span class="kw3">say</span> <span class="st0">"Deterministic output at "</span><span class="sy0">,</span> DateTime<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span><span class="nu0">2177452800</span><span class="br0">)</span><span class="sy0">,</span> <span class="st0">" with fixed checks,"</span><span class="sy0">;</span><br><span class="kw1">loop</span> <span class="br0">(</span><span class="kw1">my</span> <span class="re0">$t</span> <span class="sy0">=</span> <span class="nu0">2177452800</span> <span class="sy0">;</span> <span class="re0">$t</span> <span class="sy0">&lt;</span> <span class="nu0">2177452900</span> <span class="sy0">;</span> <span class="re0">$t</span><span class="sy0">+=</span> <span class="nu0">17</span> <span class="br0">)</span> <span class="br0">{</span> <span class="co1"># Y2038 safe</span><br>   <span class="kw3">say</span> totp <span class="re0">$message</span><span class="sy0">,</span> DateTime<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span><span class="re0">$t</span><span class="br0">)</span><span class="sy0">;</span><br><span class="br0">}</span><br>&nbsp;<br><span class="kw3">say</span> <span class="st0">"Current time output at "</span><span class="sy0">,</span> DateTime<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span>now<span class="br0">)</span><span class="sy0">,</span> <span class="st0">" with random checks,"</span><span class="sy0">;</span><br><span class="kw1">loop</span> <span class="br0">(</span><span class="kw1">my</span> <span class="re0">$n</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="sy0">;</span> <span class="re0">$n</span> <span class="sy0">&lt;</span> <span class="nu0">6</span> <span class="sy0">;</span> <span class="re0">$n</span><span class="sy0">++,</span> sleep <span class="br0">(</span><span class="nu0">13</span><span class="sy0">..</span><span class="nu0">23</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">roll</span> <span class="br0">)</span> <span class="br0">{</span><br>   <span class="kw3">say</span> totp <span class="re0">$message</span><span class="sy0">,</span> DateTime<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span>now<span class="br0">)</span><span class="sy0">;</span><br><span class="br0">}</span> <br>&nbsp;</pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>Deterministic output at 2039-01-01T00:00:00Z with fixed checks,
34ca2a
acfa3f
950fc3
950fc3
a2d4ea
a2d4ea
Current time output at 2019-03-31T15:00:01.765312Z with random checks,
4e36de
d4e9f8
d4e9f8
077e2c
63bbb5
63bbb5</pre>
<h2><span class="mw-headline" id="Tcl"><a href="https://rosettacode.org/wiki/Category:Tcl" title="Category:Tcl">Tcl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=11" title="Edit section: Tcl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This TOTP/HOTP module clocks in small by taking advantage of <a rel="nofollow" class="external text" href="https://core.tcl.tk/tcllib/doc/trunk/embedded/www/toc.html">tcllib's</a> existing hashing and base32 modules.
</p>
<pre class="tcl highlighted_source">&nbsp;<br><span class="co1"># rfc6238 contains examples of hotp with 8-digit modulus and sha1/sha256/sha512 hmac</span><br><span class="co1">#</span><br><span class="co1"># these require options handling, perhaps http://wiki.tcl.tk/38965</span><br><span class="co1">#</span><br><span class="kw1">catch</span> <span class="br0">{</span><span class="kw1">namespace</span> delete&nbsp;::<span class="me1">totp</span><span class="br0">}</span><br><span class="kw1">namespace</span> <span class="kw1">eval</span>&nbsp;::<span class="me1">totp</span> <span class="br0">{</span><br>    <span class="kw2">package</span> require sha1<br>&nbsp;<br>    oo::<span class="me1">class</span> create totp <span class="br0">{</span><br>        <span class="kw1">variable</span> Secret<br>        <span class="kw1">variable</span> Interval<br>        <span class="kw1">variable</span> Window<br>        constructor <span class="br0">{</span>secret <span class="br0">{</span>interval <span class="nu0">30</span><span class="br0">}</span> <span class="br0">{</span>window <span class="nu0">300</span><span class="br0">}</span><span class="br0">}</span> <span class="br0">{</span><br>            <span class="kw1">if</span> <span class="br0">{</span><span class="sy0">!</span><span class="br0">[</span><span class="kw2">string</span> is digit <span class="re0">$interval</span><span class="br0">]</span><span class="br0">}</span> <span class="br0">{</span><br>                <span class="kw1">set</span> interval <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="br0">[</span><span class="kw2">clock</span> <span class="kw2">scan</span> <span class="re0">$interval</span><span class="br0">]</span> - <span class="br0">[</span><span class="kw2">clock</span> <span class="kw2">scan</span> now<span class="br0">]</span><span class="br0">}</span><span class="br0">]</span><br>            <span class="br0">}</span><br>            <span class="kw1">if</span> <span class="br0">{</span><span class="sy0">!</span><span class="br0">[</span><span class="kw2">string</span> is digit <span class="re0">$window</span><span class="br0">]</span><span class="br0">}</span> <span class="br0">{</span><br>                <span class="kw1">set</span> window <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="br0">[</span><span class="kw2">clock</span> <span class="kw2">scan</span> <span class="re0">$window</span><span class="br0">]</span> - <span class="br0">[</span><span class="kw2">clock</span> <span class="kw2">scan</span> now<span class="br0">]</span><span class="br0">}</span><span class="br0">]</span><br>            <span class="br0">}</span><br>            <span class="kw1">if</span> <span class="br0">{</span><span class="re0">$window</span> <span class="sy0">%</span> <span class="re0">$interval</span><span class="br0">}</span> <span class="br0">{</span><br>                throw <span class="br0">{</span>TOTP BADARGS<span class="br0">}</span> <span class="st0">"$window is not a multiple of $interval"</span><br>            <span class="br0">}</span> <br>            <span class="kw1">set</span> window <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="re0">$window</span> / <span class="re0">$interval</span><span class="br0">}</span><span class="br0">]</span><br>            <span class="kw1">set</span> Secret <span class="re0">$secret</span><br>            <span class="kw1">set</span> Interval <span class="re0">$interval</span><br>            <span class="kw1">set</span> Window <span class="re0">$window</span><br>        <span class="br0">}</span><br>        <span class="kw1">method</span> totp <span class="br0">{</span><span class="br0">{</span>when now<span class="br0">}</span><span class="br0">}</span> <span class="br0">{</span><br>            <span class="kw1">if</span> <span class="br0">{</span><span class="sy0">!</span><span class="br0">[</span><span class="kw2">string</span> is integer <span class="re0">$when</span><span class="br0">]</span><span class="br0">}</span> <span class="br0">{</span><br>                <span class="kw1">set</span> when <span class="br0">[</span><span class="kw2">clock</span> <span class="kw2">scan</span> <span class="re0">$when</span><span class="br0">]</span><br>            <span class="br0">}</span><br>            <span class="kw1">set</span> when <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="re0">$when</span> / <span class="re0">$Interval</span><span class="br0">}</span><span class="br0">]</span><br>            <span class="kw1">set</span> bytes <span class="br0">[</span><span class="kw2">binary</span> <span class="kw2">format</span> W <span class="re0">$when</span><span class="br0">]</span><br>            <span class="kw2">binary</span> <span class="kw2">scan</span> <span class="re0">$bytes</span> H<span class="sy0">*</span> when<br>            hotp <span class="re0">$Secret</span> <span class="re0">$bytes</span><br>        <span class="br0">}</span><br>&nbsp;<br>    <span class="br0">}</span><br>&nbsp;<br>    <span class="kw1">proc</span> hotp <span class="br0">{</span>secret bytes <span class="br0">{</span>length <span class="nu0">6</span><span class="br0">}</span><span class="br0">}</span> <span class="br0">{</span><br>        <span class="kw1">set</span> hmac <span class="br0">[</span>sha1::<span class="me1">hmac</span> -bin <span class="re0">$secret</span> <span class="re0">$bytes</span><span class="br0">]</span><br>        <span class="kw1">set</span> ofs <span class="br0">[</span><span class="kw2">string</span> index <span class="re0">$hmac</span> end<span class="br0">]</span><br>        <span class="kw2">binary</span> <span class="kw2">scan</span> <span class="re0">$ofs</span> c ofs<br>        <span class="kw1">set</span> ofs <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="re0">$ofs</span> <span class="sy0">&amp;</span> 0xf<span class="br0">}</span><span class="br0">]</span><br>        <span class="kw1">set</span> chunk <span class="br0">[</span><span class="kw2">string</span> range <span class="re0">$hmac</span> <span class="re0">$ofs</span> <span class="re0">$ofs</span>+<span class="nu0">4</span><span class="br0">]</span><br>        <span class="kw2">binary</span> <span class="kw2">scan</span> <span class="re0">$chunk</span> I code<br>        <span class="kw1">return</span> <span class="br0">[</span><span class="kw2">format</span> <span class="sy0">%</span>0<span class="sy0">$</span><span class="br0">{</span>length<span class="br0">}</span>.<span class="sy0">$</span><span class="br0">{</span>length<span class="br0">}</span>d <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="br0">(</span><span class="re0">$code</span> <span class="sy0">&amp;</span> 0x7fffffff<span class="br0">)</span> <span class="sy0">%</span> <span class="nu0">10</span> <span class="sy0">**</span> <span class="re0">$length</span><span class="br0">}</span><span class="br0">]</span><span class="br0">]</span><br>&nbsp;<br>    <span class="br0">}</span><br>&nbsp;<br>    <span class="kw1">namespace</span> export <span class="sy0">*</span><br><span class="br0">}</span><br><span class="kw1">namespace</span> import&nbsp;::<span class="me1">totp</span>::<span class="sy0">*</span><br>&nbsp;<br><span class="kw1">if</span> <span class="nu0">0</span> <span class="br0">{</span>  <span class="sy0">;</span><span class="co1"># tests</span><br>    <span class="kw1">if</span> <span class="br0">{</span><span class="br0">[</span><span class="kw2">info</span> commands assert<span class="br0">]</span> eq <span class="st0">""</span><span class="br0">}</span> <span class="br0">{</span><br>        <span class="kw1">proc</span> assert <span class="br0">{</span>what<span class="br0">}</span> <span class="br0">{</span><br>            <span class="kw2">puts</span> <span class="br0">[</span><span class="kw1">uplevel</span> <span class="nu0">1</span> <span class="br0">[</span><span class="kw2">list</span> <span class="kw2">subst</span> <span class="re0">$what</span><span class="br0">]</span><span class="br0">]</span><br>        <span class="br0">}</span><br>    <span class="br0">}</span><br>    totp::<span class="me1">totp</span> create t <span class="nu0">12345678901234567890</span><br>    assert <span class="br0">{</span><span class="nu0">287082</span> eq <span class="br0">[</span>t totp <span class="nu0">59</span><span class="br0">]</span><span class="br0">}</span><br>&nbsp;<br>    t destroy<br>    <span class="kw2">package</span> require base32<br>    totp::<span class="me1">totp</span> create t <span class="br0">[</span>base32::<span class="me1">decode</span> AAAAAAAAAAAAAAAA<span class="br0">]</span><br>    <span class="kw1">proc</span> google <span class="br0">{</span>when<span class="br0">}</span> <span class="br0">{</span><br>        <span class="kw2">list</span> <span class="br0">[</span>t totp <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="re0">$when</span>-<span class="nu0">30</span><span class="br0">}</span><span class="br0">]</span><span class="br0">]</span> <span class="br0">[</span>t totp <span class="re0">$when</span><span class="br0">]</span> <span class="br0">[</span>t totp <span class="br0">[</span><span class="kw1">expr</span> <span class="br0">{</span><span class="re0">$when</span>+<span class="nu0">30</span><span class="br0">}</span><span class="br0">]</span><span class="br0">]</span><br>    <span class="br0">}</span><br>    assert <span class="br0">{</span><span class="br0">{</span><span class="nu0">306281</span> <span class="nu0">553572</span> <span class="nu0">304383</span><span class="br0">}</span> eq <span class="br0">[</span>google <span class="nu0">1400000000</span><span class="br0">]</span><span class="br0">}</span><br><span class="br0">}</span></pre>
<h2><span class="mw-headline" id="Wren"><a href="https://rosettacode.org/wiki/Category:Wren" title="Category:Wren">Wren</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=12" title="Edit section: Wren">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta translation"><b>Translation of</b>: <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Go">Go</a></div>
<div class="examplemeta libheader"><b>Library:</b> <a href="https://rosettacode.org/wiki/Category:Wren-long" title="Category:Wren-long">Wren-long</a></div>
<div class="examplemeta libheader"><b>Library:</b> <a href="https://rosettacode.org/wiki/Category:Wren-crypto" title="Category:Wren-crypto">Wren-crypto</a></div>
<div class="examplemeta libheader"><b>Library:</b> <a href="https://rosettacode.org/wiki/Category:Wren-date" title="Category:Wren-date">Wren-date</a></div>
<div class="examplemeta libheader"><b>Library:</b> <a href="https://rosettacode.org/wiki/Category:Wren-srandom" title="Category:Wren-srandom">Wren-srandom</a></div>
<p>As Wren-cli currently has no way of determining the Unix time, this needs to be input as a command line parameter so we can track it from there.
</p>
<pre class="ecmascript highlighted_source"><span class="kw3">import</span> <span class="st0">"os"</span> <span class="kw2">for</span> Process<br><span class="kw3">import</span> <span class="st0">"./long"</span> <span class="kw2">for</span> ULong<br><span class="kw3">import</span> <span class="st0">"./crypto"</span> <span class="kw2">for</span> Bytes<span class="sy0">,</span> Sha1<span class="sy0">,</span> Sha256<span class="sy0">,</span> Hmac<br><span class="kw3">import</span> <span class="st0">"./date"</span> <span class="kw2">for</span> <span class="kw5">Date</span><br><span class="kw3">import</span> <span class="st0">"./srandom"</span> <span class="kw2">for</span> SRandom<br>&nbsp;<br><span class="kw2">var</span> StartTime <span class="sy0">=</span> <span class="kw1">null</span>  <span class="co1">// time program was started (as a Unix timestamp)</span><br>&nbsp;<br><span class="kw3">class</span> OneTimePassword <span class="br0">{</span><br>    construct <span class="kw2">new</span><span class="br0">(</span>digit<span class="sy0">,</span> timeStep<span class="sy0">,</span> baseTime<span class="sy0">,</span> hashClass<span class="br0">)</span> <span class="br0">{</span><br>        _digit <span class="sy0">=</span> digit            <span class="co1">// length of code generated</span><br>        _timeStep <span class="sy0">=</span> timeStep      <span class="co1">// length of each time step for TOTP</span><br>        _baseTime <span class="sy0">=</span> baseTime      <span class="co1">// start time for TOTP step calculation (as a Unix timestamp)</span><br>        _hashClass <span class="sy0">=</span> hashClass    <span class="co1">// hash class to be used with HMAC</span><br>    <span class="br0">}</span><br>&nbsp;<br>    <span class="co1">// Convenience version of above which uses defaults values for all except 'digit' parameter.</span><br>    <span class="kw3">static</span> simple<span class="br0">(</span>digit<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">new</span><span class="br0">(</span>digit<span class="sy0">,</span> <span class="nu0">30</span><span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> Sha1<span class="br0">)</span> <span class="br0">}</span><br>&nbsp;<br>    <span class="co1">// Returns a HOTP code with the given secret and counter.</span><br>    hotp<span class="br0">(</span>secret<span class="sy0">,</span> count<span class="br0">)</span> <span class="br0">{</span> truncate_<span class="br0">(</span>hmacSum_<span class="br0">(</span>secret<span class="sy0">,</span> count<span class="br0">)</span><span class="br0">)</span> <span class="br0">}</span><br>&nbsp;<br>    <span class="co1">// Returns a TOTP code calculated with the current time and the given secret.</span><br>    totp<span class="br0">(</span>secret<span class="br0">)</span> <span class="br0">{</span> hotp<span class="br0">(</span>secret<span class="sy0">,</span> steps_<span class="br0">(</span>timeNow_<span class="br0">)</span><span class="br0">)</span> <span class="br0">}</span><br>&nbsp;<br>    <span class="coMULTI">/* private helper methods */</span><br>&nbsp;<br>    hmacSum_<span class="br0">(</span>secret<span class="sy0">,</span> count<span class="br0">)</span> <span class="br0">{</span><br>        <span class="kw2">var</span> msg <span class="sy0">=</span> ULong<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span>count<span class="br0">)</span><span class="sy0">.</span><span class="me1">toBytes</span><span class="br0">[</span><span class="sy0">-</span><span class="nu0">1</span><span class="sy0">..</span><span class="nu0">0</span><span class="br0">]</span> <span class="co1">// big-endian</span><br>        <span class="kw2">return</span> Bytes<span class="sy0">.</span><span class="me1">fromHexString</span><span class="br0">(</span>Hmac<span class="sy0">.</span><span class="me1">digest</span><span class="br0">(</span>secret<span class="sy0">,</span> msg<span class="sy0">,</span> Sha1<span class="br0">)</span><span class="br0">)</span><br>    <span class="br0">}</span><br>&nbsp;<br>    dt_<span class="br0">(</span>hs<span class="br0">)</span> <span class="br0">{</span><br>        <span class="kw2">var</span> offset <span class="sy0">=</span> hs<span class="br0">[</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">]</span> <span class="sy0">&amp;</span> <span class="nu12">0xf</span><br>        <span class="kw2">var</span> p <span class="sy0">=</span> hs<span class="br0">[</span>offset<span class="sy0">...</span><span class="me1">offset</span><span class="sy0">+</span><span class="nu0">4</span><span class="br0">]</span><br>        p<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">=</span> p<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">&amp;</span> <span class="nu12">0x7f</span><br>        <span class="kw2">return</span> p<br>    <span class="br0">}</span><br>&nbsp;<br>    truncate_<span class="br0">(</span>hs<span class="br0">)</span> <span class="br0">{</span><br>        <span class="kw2">var</span> sbits <span class="sy0">=</span> dt_<span class="br0">(</span>hs<span class="br0">)</span><br>        <span class="kw2">var</span> snum <span class="sy0">=</span> Bytes<span class="sy0">.</span><span class="me1">toIntBE</span><span class="br0">(</span>sbits<span class="br0">)</span><br>        <span class="kw2">var</span> pwr <span class="sy0">=</span> <span class="nu0">10</span><span class="sy0">.</span><span class="me1">pow</span><span class="br0">(</span>_digit<span class="br0">)</span><br>        <span class="kw2">return</span> snum <span class="sy0">%</span> pwr<br>    <span class="br0">}</span><br>&nbsp;<br>    steps_<span class="br0">(</span>now<span class="br0">)</span> <span class="br0">{</span> <span class="br0">(</span><span class="br0">(</span>now <span class="sy0">-</span> _baseTime<span class="br0">)</span><span class="sy0">/</span>_timeStep<span class="br0">)</span><span class="sy0">.</span><span class="me1">floor</span> <span class="br0">}</span><br>&nbsp;<br>    timeNow_ <span class="br0">{</span> <span class="br0">(</span>StartTime <span class="sy0">+</span> System<span class="sy0">.</span><span class="me1">clock</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">floor</span> <span class="br0">}</span><br><span class="br0">}</span><br>&nbsp;<br><span class="kw2">var</span> args <span class="sy0">=</span> Process<span class="sy0">.</span><span class="kw8">arguments</span><br><span class="kw2">if</span> <span class="br0">(</span>args<span class="sy0">.</span><span class="me1">count</span> <span class="sy0">!=</span> <span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span><br>    System<span class="sy0">.</span><span class="me1">print</span><span class="br0">(</span><span class="st0">"Please pass the Unix timestamp when starting the program."</span><span class="br0">)</span><br>    <span class="kw2">return</span><br><span class="br0">}</span><br>StartTime <span class="sy0">=</span> Num<span class="sy0">.</span><span class="me1">fromString</span><span class="br0">(</span>args<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><br><span class="kw2">var</span> secret <span class="sy0">=</span> <span class="st0">"SOME_SECRET"</span><span class="sy0">.</span><span class="me1">bytes</span><span class="sy0">.</span><span class="me1">toList</span><br>&nbsp;<br><span class="co1">// Simple 6-digit HOTP code.</span><br><span class="kw2">var</span> otp <span class="sy0">=</span> OneTimePassword<span class="sy0">.</span><span class="me1">simple</span><span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span><br>System<span class="sy0">.</span><span class="me1">print</span><span class="br0">(</span>otp<span class="sy0">.</span><span class="me1">hotp</span><span class="br0">(</span>secret<span class="sy0">,</span> <span class="nu0">123456</span><span class="br0">)</span><span class="br0">)</span><br>&nbsp;<br><span class="co1">// Google authenticator style 8-digit TOTP code.</span><br>otp <span class="sy0">=</span> OneTimePassword<span class="sy0">.</span><span class="me1">simple</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><br>System<span class="sy0">.</span><span class="me1">print</span><span class="br0">(</span>otp<span class="sy0">.</span><span class="me1">totp</span><span class="br0">(</span>secret<span class="br0">)</span><span class="br0">)</span><br>&nbsp;<br><span class="co1">// Custom 9 digit, 5 second step TOTP starting on midnight 2000-01-01 UTC, using Sha256.</span><br><span class="kw2">var</span> baseTime <span class="sy0">=</span> <span class="kw5">Date</span><span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span><span class="nu0">2000</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">unixTime</span><br>otp <span class="sy0">=</span> OneTimePassword<span class="sy0">.</span><span class="kw2">new</span><span class="br0">(</span><span class="nu0">9</span><span class="sy0">,</span> <span class="nu0">5</span><span class="sy0">,</span> baseTime<span class="sy0">,</span> Sha256<span class="br0">)</span><br>System<span class="sy0">.</span><span class="me1">print</span><span class="br0">(</span>otp<span class="sy0">.</span><span class="me1">totp</span><span class="br0">(</span>secret<span class="br0">)</span><span class="br0">)</span><br>&nbsp;<br><span class="co1">// As above using a random, 32 byte, Base32 key</span><br><span class="kw2">var</span> alphabet <span class="sy0">=</span> <span class="st0">"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"</span> <span class="co1">// for Base32</span><br><span class="kw2">var</span> randKey <span class="sy0">=</span> List<span class="sy0">.</span><span class="me1">filled</span><span class="br0">(</span><span class="nu0">32</span><span class="sy0">,</span> <span class="kw1">null</span><span class="br0">)</span><br><span class="kw2">for</span> <span class="br0">(</span>i <span class="kw2">in</span> <span class="nu0">0</span><span class="sy0">..</span><span class="nu0">31</span><span class="br0">)</span> randKey<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> alphabet<span class="br0">[</span>SRandom<span class="sy0">.</span><span class="kw3">int</span><span class="br0">(</span><span class="nu0">32</span><span class="br0">)</span><span class="br0">]</span><br>System<span class="sy0">.</span><span class="me1">print</span><span class="br0">(</span>otp<span class="sy0">.</span><span class="me1">totp</span><span class="br0">(</span>randKey<span class="sy0">.</span><span class="me1">join</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">.</span><span class="me1">bytes</span><span class="sy0">.</span><span class="me1">toList</span><span class="br0">)</span><span class="br0">)</span></pre>
<div>
<dl><dt>Output:</dt></dl></div>
<p>Sample output:
</p>
<pre>$ date '+%s'
1638830494
$ wren-cli totp.wren 1638830494
260040
24454221
189816119
499920719
</pre>
<h2><span class="mw-headline" id="zkl"><a href="https://rosettacode.org/wiki/Category:Zkl" title="Category:Zkl">zkl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=edit&amp;section=13" title="Edit section: zkl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Uses the MsgHash dll, which includes SHA-1, SHA-256 hashes and HMAC routines for SHA-* and MD5.
</p>
<div class="examplemeta translation"><b>Translation of</b>: <a href="https://rosettacode.org/wiki/Time-based_one-time_password_algorithm#Go">Go</a></div>
<pre class="text highlighted_source">var [const] MsgHash = Import.lib("zklMsgHash");<br>&nbsp;<br>// OneTimePassword stores the configuration values relevant to HOTP/TOTP calculations.<br>class OneTimePassword{<br>   fcn init(Digit,TimeStep,BaseTime,HMAC){<br>      var digit   =Digit,	// Length of code generated, # digits<br>	  timeStep=TimeStep,	// Length of each time step for TOTP, in seconds<br>	  baseTime=BaseTime, 	// The start time for TOTP step calculation (seconds since Unix epoch)<br>	  hmac    =HMAC;	// Hash algorithm used with HMAC --&gt; bytes<br>   }<br>   // hotp returns a HOTP code with the given secret and counter.<br>   fcn hotp(secret,count){ // eg ("SOME_SECRET",123456)<br>      hmac(secret,count.toBigEndian(8))&nbsp;: // (key,msg), msg is count as 8 bytes<br>      // --&gt; 20 bytes (SHA1), eg (de,7c,9b,85,b8,b7,8a,a6,bc,8a,7a,36,f7,0a,90,70,1c,9d,b4,d9)<br>      truncate(_)<br>   }<br>   fcn truncate(hs)  // pick off bottom digit digits<br>      { dt(hs)&nbsp;% (10).pow(digit) }<br>   fcn dt(hs){ <br>      hs[-1].bitAnd(0xf)&nbsp;: // bottom 4 bits (0-15) of LSB of hash to index<br>      hs.toBigEndian(_,4)  // 4 bytes of hash to 32 bit unsigned int<br>   }<br>&nbsp;<br>   // Simple returns a new OneTimePassword with the specified HTOP code length,<br>   // SHA-1 as the HMAC hash algorithm, the Unix epoch as the base time, and<br>   // 30 seconds as the step length.<br>   fcn simple(digit){ //--&gt; OneTimePassword<br>      if(digit&lt;6)<br>	 throw(Exception.ValueError("minimum of 6 digits is required for a valid HTOP code"));<br>      if(digit&gt;9)<br>	 throw(Exception.ValueError("HTOP code cannot be longer than 9 digits"));<br>      self(digit,30,0,MsgHash.extra.hmacSHA1.fp2(False))<br>   }<br>   // TOTP returns a TOTP code calculated with the current time and the given secret.<br>   fcn totp(secret){ hotp(secret, steps(Time.Clock.time())) }<br>   fcn steps(now)  { (now - baseTime)/timeStep } // elapsed time chunked<br>} // OneTimePassword</pre>
<p>Note: MsgHash hashes return a string by default, they can also return the hash as bytes. Ditto the HMAC routines, it is the third parameter. So, to create a hmac that returns bytes, use (eg) MsgHash.extra.hmacSHA1.fp2(False), this creates a partial application (closure) of the hmac using SHA-1 fixing the third parameter as False.
</p>
<div>
<dl><dt>Example uses:</dt></dl></div>
<pre class="text highlighted_source">fcn example_simple{<br>   // Simple 6-digit HOTP code:<br>   secret &nbsp;:= "SOME_SECRET";<br>   counter&nbsp;:= 123456;<br>   otp    &nbsp;:= OneTimePassword.simple(6);<br>   code   &nbsp;:= otp.hotp(secret, counter);<br>   println(code);  //--&gt;260040 (const)<br>}();<br>&nbsp;<br>fcn example_authenticator{<br>   // Google authenticator style 8-digit TOTP code:<br>   secret&nbsp;:= "SOME_SECRET";<br>   otp   &nbsp;:= OneTimePassword.simple(8);<br>   code  &nbsp;:=otp.totp(secret);<br>   println(code)  //--&gt;eg 44653788<br>}();<br>&nbsp;<br>fcn example_custom{<br>   // 9-digit 5-second-step TOTP starting on midnight 2000-01-01 UTC, using SHA-256:<br>   secret&nbsp;:= "SOME_SECRET";<br>   ts    &nbsp;:= 5;  // seconds<br>   t     &nbsp;:= Time.Clock.mktime(2000,1,1, 0,0,0); //(Y,M,D, h,m,s)<br>   otp   &nbsp;:= OneTimePassword(9,ts,t,MsgHash.extra.hmacSHA256.fp2(False));<br>   code  &nbsp;:= otp.totp(secret);<br>   println(code)  //--&gt;eg 707355416<br>}();</pre>
<div>
<dl><dt>Example use:</dt></dl></div>
<p>Showing how to sync with changes over time. A six digit OTP w/MD5 changing every 17 seconds. Latency can effect the result when totp is called at a time boundary, so a retry may be required.
</p>
<pre class="text highlighted_source">fcn overTime{<br>   secret,ts:= "SOME_SECRET",17;<br>   otp     &nbsp;:= OneTimePassword(6,ts,Time.Clock.time(),MsgHash.extra.hmacMD5.fp2(False));<br>   chg,s   &nbsp;:= 0,"";<br>   while(1){<br>      code,t&nbsp;:= otp.totp(secret),Time.Clock.time() - otp.baseTime;<br>      if(t/ts!=chg){ chg = t/ts; s=" (should change)"; }<br>      println("%4d:&nbsp;%6d&nbsp;%s".fmt(t,code,s)); s = "";<br>      Atomic.sleep(10);<br>   }<br>}</pre>
<div>
<dl><dt>Output:</dt></dl></div>
<pre>   0:  53454 
  10:  53454 
  20:   2947  (should change)
  30:   2947 
  40: 287972  (should change)
  50: 287972 
...
 220: 510180 
 230:    207  (should change)
 240: 380959  (should change)
 250: 380959 
</pre>
<div>
<dl><dt>HMAC code:</dt></dl></div> 
<p>The MsgHash HMAC routines are pretty simple (the hash code is C), included here for completeness:
</p>
<pre class="text highlighted_source">// https://en.wikipedia.org/wiki/Hash-based_message_authentication_code<br>fcn hmac(key,msg,hashFcn,asString){<br>   blkSz,H,Hx&nbsp;:= 64,hashFcn.fp1(1,Data()), (asString and hashFcn or H);<br>   kn:=key.len();<br>   if(kn&gt;blkSz) key=H(key).howza(0);<br>   else         key=Data().fill(0,blkSz-kn).write(key).howza(0);<br>   opad:=key.pump(Data,(0x5c).bitXor);<br>   ipad:=key.pump(Data,(0x36).bitXor);<br>&nbsp;<br>   Hx(opad + H(ipad + msg))  //--&gt;String|Data<br>}<br>fcn hmacSHA1(  key,msg,asString=True){ hmac(key,msg,MsgHash.SHA1,  asString) }<br>fcn hmacSHA256(key,msg,asString=True){ hmac(key,msg,MsgHash.SHA256,asString) }<br>fcn hmacMD5(   key,msg,asString=True){ hmac(key,msg,Utils.MD5.calc,asString) }</pre>



</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;oldid=349425">https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;oldid=349425</a>"</div>
</div>

<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://rosettacode.org/wiki/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://rosettacode.org/wiki/Category:Draft_Programming_Tasks" title="Category:Draft Programming Tasks">Draft Programming Tasks</a></li><li><a href="https://rosettacode.org/mw/index.php?title=Category:Security&amp;action=edit&amp;redlink=1" class="new" title="Category:Security (page does not exist)">Security</a></li><li><a href="https://rosettacode.org/wiki/Category:WikipediaSourced" title="Category:WikipediaSourced">WikipediaSourced</a></li><li><a href="https://rosettacode.org/wiki/Category:C_sharp" title="Category:C sharp">C sharp</a></li><li><a href="https://rosettacode.org/wiki/Category:Cach%C3%A9_ObjectScript" title="Category:Cach√© ObjectScript">Cach√© ObjectScript</a></li><li><a href="https://rosettacode.org/wiki/Category:Go" title="Category:Go">Go</a></li><li><a href="https://rosettacode.org/wiki/Category:Julia" title="Category:Julia">Julia</a></li><li><a href="https://rosettacode.org/wiki/Category:Nim" title="Category:Nim">Nim</a></li><li><a href="https://rosettacode.org/wiki/Category:Perl" title="Category:Perl">Perl</a></li><li><a href="https://rosettacode.org/wiki/Category:Phix" title="Category:Phix">Phix</a></li><li><a href="https://rosettacode.org/wiki/Category:PicoLisp" title="Category:PicoLisp">PicoLisp</a></li><li><a href="https://rosettacode.org/wiki/Category:Racket" title="Category:Racket">Racket</a></li><li><a href="https://rosettacode.org/wiki/Category:Raku" title="Category:Raku">Raku</a></li><li><a href="https://rosettacode.org/wiki/Category:Tcl" title="Category:Tcl">Tcl</a></li><li><a href="https://rosettacode.org/wiki/Category:Wren" title="Category:Wren">Wren</a></li><li><a href="https://rosettacode.org/wiki/Category:Wren-long" title="Category:Wren-long">Wren-long</a></li><li><a href="https://rosettacode.org/wiki/Category:Wren-crypto" title="Category:Wren-crypto">Wren-crypto</a></li><li><a href="https://rosettacode.org/wiki/Category:Wren-date" title="Category:Wren-date">Wren-date</a></li><li><a href="https://rosettacode.org/wiki/Category:Wren-srandom" title="Category:Wren-srandom">Wren-srandom</a></li><li><a href="https://rosettacode.org/wiki/Category:Zkl" title="Category:Zkl">Zkl</a></li></ul></div></div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<nav class="navbar navbar-default p-tb " id="p-tb">
<ul class="nav navbar-nav small">
<li id="t-whatlinkshere"><a href="https://rosettacode.org/wiki/Special:WhatLinksHere/Time-based_one-time_password_algorithm" title="A list of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li>
<li id="t-recentchangeslinked"><a href="https://rosettacode.org/wiki/Special:RecentChangesLinked/Time-based_one-time_password_algorithm" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="https://rosettacode.org/wiki/Special:SpecialPages" title="A list of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li>
<li id="t-print"><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;printable=yes" rel="alternate" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>
<li id="t-permalink"><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;oldid=349425" title="Permanent link to this revision of the page">Permanent link</a></li>
<li id="t-info"><a href="https://rosettacode.org/mw/index.php?title=Time-based_one-time_password_algorithm&amp;action=info" title="More information about this page">Page information</a></li>
 <li id="t-smwbrowselink"><a href="https://rosettacode.org/wiki/Special:Browse/Time-2Dbased_one-2Dtime_password_algorithm" rel="smw-browse">Browse properties</a></li>
</ul>
</nav>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<ul class="footer-info list-unstyled small" id="footer-info">

<li> This page was last modified on 6 December 2021, at 22:43.</li>
<li>Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/licenses/fdl-1.2.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
</ul>
</div>
</div>
<div class="row">
<div class="col-lg-6">

<ul class="list-inline footer-places " id="footer-places">
<li><small><a href="https://rosettacode.org/wiki/Rosetta_Code:Privacy_policy" title="Rosetta Code:Privacy policy">Privacy policy</a></small></li>
<li><small><a href="https://rosettacode.org/wiki/Rosetta_Code:About" title="Rosetta Code:About">About Rosetta Code</a></small></li>
<li><small><a href="https://rosettacode.org/wiki/Rosetta_Code:General_disclaimer" title="Rosetta Code:General disclaimer">Disclaimers</a></small></li>
</ul>
</div>
<div class="col-lg-6">

<ul class="list-inline pull-right footer-icons " id="footer-icons">

<li><a href="https://www.gnu.org/licenses/fdl-1.2.html"><img src="./totp_files/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31"></a></li>

<li><a href="https://www.mediawiki.org/"><img src="./totp_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/mw/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /mw/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a></li>
<li><a href="https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki"><img src="./totp_files/smw_button.png" alt="Powered by Semantic MediaWiki" width="88" height="31"></a></li>
</ul>
</div>
</div>
</div><script type="text/javascript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.bootstrap.scripts"]);
} );</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-1219419-1"]);
  _gaq.push(["_trackPageview"]);

  (function() {
    var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
    ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
    var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":1312});
} );</script>
<div class="suggestions" style="display: none; font-size: 14px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>